# Electronæ˜¯ä»€ä¹ˆï¼Ÿ

Electronæ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScriptã€HTML å’Œ CSS æ„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ åµŒå…¥ [Chromium](https://www.chromium.org/) å’Œ [Node.js](https://nodejs.org/) åˆ° äºŒè¿›åˆ¶çš„ Electron å…è®¸æ‚¨ä¿æŒä¸€ä¸ª JavaScript ä»£ç ä»£ç åº“å¹¶åˆ›å»º åœ¨Windowsä¸Šè¿è¡Œçš„è·¨å¹³å°åº”ç”¨ macOSå’ŒLinuxâ€”â€”ä¸éœ€è¦æœ¬åœ°å¼€å‘ ç»éªŒã€‚

## å…¥é—¨æŒ‡å—

æˆ‘ä»¬æ¨èæ‚¨ä» [æ•™ç¨‹](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)å¼€å§‹ï¼Œ åœ¨å¼€å‘Electronåº”ç”¨ç¨‹åºå¹¶å°†å…¶åˆ†å‘ç»™ç”¨æˆ·çš„è¿‡ç¨‹ä¸­å‘æ‚¨æä¾›æŒ‡å¯¼ã€‚ [ç¤ºä¾‹](https://www.electronjs.org/zh/docs/latest/tutorial/examples) ä¸ [API æ–‡æ¡£](https://www.electronjs.org/zh/docs/latest/api/app) ä¹Ÿæ˜¯æµè§ˆå¹¶å‘ç°æ–°äº‹ç‰©çš„å¥½åœ°æ–¹ã€‚

## Electron Fiddle è¿è¡Œå®ä¾‹

[Electron Fiddle](https://www.electronjs.org/fiddle) æ˜¯ç”± Electron å¼€å‘å¹¶ç”±å…¶ç»´æŠ¤è€…æ”¯æŒçš„æ²™ç›’ç¨‹åºã€‚ æˆ‘ä»¬å¼ºçƒˆå»ºè®®å°†å…¶ä½œä¸ºä¸€ä¸ªå­¦ä¹ å·¥å…·æ¥å®‰è£…ï¼Œä»¥ä¾¿åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹Electronçš„apiè¿›è¡Œå®éªŒæˆ–å¯¹ç‰¹æ€§è¿›è¡ŒåŸå‹åŒ–ã€‚

Fiddle å·²ç»å®Œç¾çš„é›†æˆåˆ°æˆ‘ä»¬çš„å¸®åŠ©æ–‡æ¡£ä¹‹ä¸­ã€‚ å½“ä½ æµè§ˆæˆ‘ä»¬æ•™ç¨‹ä¸­çš„ä¾‹å­ï¼Œä½ ä¼šå‘ç°æœ‰ä¸ªã€ŒOpen In Electron Fiddleã€æŒ‰é’®åœ¨ä»£ç ç¤ºä¾‹ä¸­ã€‚ å¦‚æœä½ å·²ç»å®‰è£…äº† Fiddleï¼Œã€ŒOpen In Electron Fiddleã€æŒ‰é’®ä¼šæ‰“å¼€ä¸€ä¸ª `fiddle.electronjs.org` é“¾æ¥å¹¶åŠ è½½ç¤ºä¾‹ã€‚ `fiddle docs/latest/fiddles/quick-start`

## æ–‡æ¡£åŒ…å«å“ªäº›å†…å®¹ï¼Ÿ

æ‰€æœ‰å®˜æ–¹æ–‡æ¡£éƒ½å¯ä»¥åœ¨ä¾§è¾¹æ ä¸­æŸ¥é˜…ã€‚ ä»¥ä¸‹æ˜¯å‡ ä¸ªç±»åˆ«ï¼Œä»¥åŠç›¸åº”çš„ä»‹ç»ï¼š

- **æ•™ç¨‹**ï¼šå¦‚ä½•åˆ›å»ºå¹¶å‘å¸ƒæ‚¨çš„ç¬¬ä¸€ä¸ª Electron ç¨‹åºã€‚
- **Electron è¿›ç¨‹**ï¼šå¯¹ Electron ä¸­çš„è¿›ç¨‹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„å‚è€ƒã€‚
- **æœ€ä½³å®è·µ**ï¼šåœ¨å¼€å‘ Electron ç¨‹åºæ—¶éœ€è¦ç•™æ„çš„ä¸€äº›ç»†èŠ‚ã€‚
- **ç¤ºä¾‹ä»£ç **: æœ‰äº†ç¤ºä¾‹ä»£ç ç¨å¾®æ”¹ä¸€ä¸‹å°±å¯ä»¥æ”¾å…¥ Electron åº”ç”¨ä¸­.
- **å¼€å‘**ï¼šæœ‰å…³å¼€å‘çš„å…¶å®ƒä¸€äº›æŒ‡å¯¼ã€‚
- **åˆ†å‘**ï¼šå­¦ä¹ å¦‚ä½•å‘ç»ˆç«¯ç”¨æˆ·åˆ†å‘æ‚¨çš„ç¨‹åºã€‚
- **æ£€æµ‹å’Œè°ƒè¯•**: å¦‚ä½•è°ƒè¯• JavaScript, å¦‚ä½•ç¼–å†™æµ‹è¯•ä»£ç , è¿˜æœ‰å°±æ˜¯å¦‚ä½•ä½¿ç”¨å…¶å®ƒå·¥å…·å¿«é€Ÿåˆ›å»º Electron åº”ç”¨.
- **å¼•ç”¨**: ç‰ˆæœ¬ä¿¡æ¯ç›¸å…³è¯´æ˜
- **å‚ä¸è´¡çŒ®**: ç¼–è¯‘ Electron å¹¶å°è¯•å‚ä¸è´¡çŒ®. æˆ‘ä»¬æ­£åœ¨å°½åŠ›è®©è¿™ä¸€æ­¥éª¤æ›´åŠ ç®€å•ã€‚

## å¯»æ±‚å¸®åŠ©

è¿˜æ˜¯æœ‰ç–‘é—®ï¼Ÿ è¯·å‚è€ƒä¸€ä¸‹ä¾‹å­

- å¼€å‘è¿‡ç¨‹ä¸­å¦‚æœä½ éœ€è¦å¸®åŠ©ï¼Œæˆ‘ä»¬çš„ [Discord è‹±æ–‡ç¤¾åŒº](https://discord.gg/electronjs) å°†æ˜¯ç»ä½³è®¨è®ºçš„åœ°æ–¹ã€‚æˆ–å‰å¾€æˆ‘ä»¬çš„ [Discord ä¸­æ–‡ç¤¾åŒº](https://discord.gg/eZTKXHBKpK)ã€‚
- å¦‚æœåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ° `electron` packageé‡Œçš„ç–‘éš¾æ‚ç—‡ï¼Œä½ å¯ä»¥å» [GitHub issue tracker](https://github.com/electron/electron/issues) æŸ¥çœ‹æ˜¯å¦æœ‰äººå·²ç»é‡åˆ°ç›¸åŒçš„é—®é¢˜ã€‚ å¦‚æœä½ å¾ˆå¹¸è¿çš„æ‰¾åˆ° bugï¼Œæ¬¢è¿æäº¤ issue åˆ° GitHubã€‚

# å¿«é€Ÿå…¥é—¨

æœ¬æŒ‡å—å°†ä¼šé€šè¿‡ä½¿ç”¨Electronåˆ›å»ºä¸€ä¸ªæç®€çš„ Hello World åº”ç”¨ä¸€æ­¥æ­¥çš„å¸¦ä½ äº†è§£ï¼Œè¯¥åº”ç”¨ä¸[`electron/electron-quick-start`](https://github.com/electron/electron-quick-start)ç±»ä¼¼ã€‚

é€šè¿‡è¿™ä¸ªæ•™ç¨‹ï¼Œä½ çš„appå°†ä¼šæ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œæ¥å±•ç¤ºåŒ…å«å½“å‰æ­£åœ¨è¿è¡Œçš„ Chromium, Node.jsä¸ Electronwebç­‰ç‰ˆæœ¬ä¿¡æ¯çš„webç•Œé¢

## åŸºæœ¬è¦æ±‚

åœ¨ä½¿ç”¨Electronè¿›è¡Œå¼€å‘ä¹‹å‰ï¼Œæ‚¨éœ€è¦å®‰è£… [Node.js](https://nodejs.org/en/download/)ã€‚ æˆ‘ä»¬å»ºè®®æ‚¨ä½¿ç”¨æœ€æ–°çš„LTSç‰ˆæœ¬ã€‚

> è¯·ä½¿ç”¨ä¸ºä½ å¹³å°é¢„æ„å»ºçš„ Node.js å®‰è£…å™¨æ¥è¿›è¡Œå®‰è£…ï¼Œ å¦åˆ™ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä¸ä¸åŒå¼€å‘å·¥å…·ä¸å…¼å®¹çš„é—®é¢˜ã€‚

è¦æ£€æŸ¥ Node.js æ˜¯å¦æ­£ç¡®å®‰è£…ï¼Œè¯·åœ¨æ‚¨çš„ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```sh
node -v
npm -v
```



è¿™ä¸¤ä¸ªå‘½ä»¤åº”è¾“å‡ºäº† Node.js å’Œ npm çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚

**æ³¨æ„** å› ä¸º Electron å°† Node.js åµŒå…¥åˆ°å…¶äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œä½ åº”ç”¨è¿è¡Œæ—¶çš„ Node.js ç‰ˆæœ¬ä¸ä½ ç³»ç»Ÿä¸­è¿è¡Œçš„ Node.js ç‰ˆæœ¬æ— å…³ã€‚

## åˆ›å»ºä½ çš„åº”ç”¨ç¨‹åº

### ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»º

Electron åº”ç”¨ç¨‹åºéµå¾ªä¸å…¶ä»– Node.js é¡¹ç›®ç›¸åŒçš„ç»“æ„ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶åˆå§‹åŒ– npm åŒ…ã€‚

- npm
- Yarn

```sh
mkdir my-electron-app && cd my-electron-app
npm init
```



`init`åˆå§‹åŒ–å‘½ä»¤ä¼šæç¤ºæ‚¨åœ¨é¡¹ç›®åˆå§‹åŒ–é…ç½®ä¸­è®¾ç½®ä¸€äº›å€¼ ä¸ºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæœ‰å‡ æ¡è§„åˆ™éœ€è¦éµå¾ªï¼š

- `entry point` åº”ä¸º `main.js`.
- `author` ä¸ `description` å¯ä¸ºä»»æ„å€¼ï¼Œä½†å¯¹äº[åº”ç”¨æ‰“åŒ…](https://www.electronjs.org/zh/docs/latest/tutorial/quick-start#package-and-distribute-your-application)æ˜¯å¿…å¡«é¡¹ã€‚

ä½ çš„ `package.json` æ–‡ä»¶åº”è¯¥åƒè¿™æ ·ï¼š

```json
{
  "name": "my-electron-app",
  "version": "1.0.0",
  "description": "Hello World!",
  "main": "main.js",
  "author": "Jane Doe",
  "license": "MIT"
}
```



ç„¶åï¼Œå°† `electron` åŒ…å®‰è£…åˆ°åº”ç”¨çš„å¼€å‘ä¾èµ–ä¸­ã€‚

- npm
- Yarn

```sh
npm install --save-dev electron
```



> æ³¨æ„ï¼šå¦‚æœæ‚¨åœ¨å®‰è£… Electron æ—¶é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯· å‚è§ [é«˜çº§å®‰è£…](https://www.electronjs.org/zh/docs/latest/tutorial/installation) æŒ‡å—ã€‚

æœ€åï¼Œæ‚¨å¸Œæœ›èƒ½å¤Ÿæ‰§è¡Œ Electron å¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨æ‚¨çš„ [`package.json`](https://docs.npmjs.com/cli/v7/using-npm/scripts)é…ç½®æ–‡ä»¶ä¸­çš„`scripts`å­—æ®µä¸‹å¢åŠ ä¸€æ¡`start`å‘½ä»¤ï¼š

```json
{
  "scripts": {
    "start": "electron ."
  }
}
```



`start`å‘½ä»¤èƒ½è®©æ‚¨åœ¨å¼€å‘æ¨¡å¼ä¸‹æ‰“å¼€æ‚¨çš„åº”ç”¨

- npm
- Yarn

```sh
npm start
```



> æ³¨æ„ï¼šæ­¤è„šæœ¬å°†å‘Šè¯‰ Electron åœ¨æ‚¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ æ­¤æ—¶ï¼Œæ‚¨çš„åº”ç”¨å°†ç«‹å³æŠ›å‡ºä¸€ä¸ªé”™è¯¯æç¤ºæ‚¨å®ƒæ— æ³•æ‰¾åˆ°è¦è¿è¡Œçš„åº”ç”¨

### è¿è¡Œä¸»è¿›ç¨‹

ä»»ä½• Electron åº”ç”¨ç¨‹åºçš„å…¥å£éƒ½æ˜¯ `main` æ–‡ä»¶ã€‚ è¿™ä¸ªæ–‡ä»¶æ§åˆ¶äº†**ä¸»è¿›ç¨‹**ï¼Œå®ƒè¿è¡Œåœ¨ä¸€ä¸ªå®Œæ•´çš„Node.jsç¯å¢ƒä¸­ï¼Œè´Ÿè´£æ§åˆ¶æ‚¨åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ˜¾ç¤ºåŸç”Ÿç•Œé¢ï¼Œæ‰§è¡Œç‰¹æ®Šæ“ä½œå¹¶ç®¡ç†æ¸²æŸ“å™¨è¿›ç¨‹(ç¨åè¯¦ç»†ä»‹ç»)ã€‚

æ‰§è¡ŒæœŸé—´ï¼ŒElectron å°†ä¾æ®åº”ç”¨ä¸­ `package.json`é…ç½®ä¸‹[`main`](https://docs.npmjs.com/cli/v7/configuring-npm/package-json#main)å­—æ®µä¸­é…ç½®çš„å€¼æŸ¥æ‰¾æ­¤æ–‡ä»¶ï¼Œæ‚¨åº”è¯¥å·²åœ¨[åº”ç”¨è„šæ‰‹æ¶](https://www.electronjs.org/zh/docs/latest/tutorial/quick-start#scaffold-the-project)æ­¥éª¤ä¸­é…ç½®ã€‚

è¦åˆå§‹åŒ–è¿™ä¸ª`main`æ–‡ä»¶ï¼Œéœ€è¦åœ¨æ‚¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`main.js`çš„ç©ºæ–‡ä»¶ã€‚

> æ³¨æ„ï¼šå¦‚æœæ‚¨æ­¤æ—¶å†æ¬¡è¿è¡Œ`start`å‘½ä»¤ï¼Œæ‚¨çš„åº”ç”¨å°†ä¸å†æŠ›å‡ºä»»ä½•é”™è¯¯ï¼ ç„¶è€Œï¼Œå®ƒä¸ä¼šåšä»»ä½•äº‹å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰åœ¨`main.js`ä¸­æ·»åŠ ä»»ä½•ä»£ç ã€‚

### åˆ›å»ºé¡µé¢

åœ¨å¯ä»¥ä¸ºæˆ‘ä»¬çš„åº”ç”¨åˆ›å»ºçª—å£å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºåŠ è½½è¿›è¯¥çª—å£çš„å†…å®¹ã€‚ åœ¨Electronä¸­ï¼Œå„ä¸ªçª—å£æ˜¾ç¤ºçš„å†…å®¹å¯ä»¥æ˜¯æœ¬åœ°HTMLæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¿œç¨‹urlã€‚

æ­¤æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†é‡‡ç”¨æœ¬åœ°HTMLçš„æ–¹å¼ã€‚ åœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`index.html`çš„æ–‡ä»¶ï¼š

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
    <title>ä½ å¥½!</title>
  </head>
  <body>
    <h1>ä½ å¥½!</h1>
    æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Node.js <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    å’Œ Electron <span id="electron-version"></span>.
  </body>
</html>
```



> æ³¨æ„ï¼šåœ¨è¿™ä¸ªHTMLæ–‡æœ¬ä¸­ï¼Œæ‚¨ä¼šå‘ç°ä¸»ä½“æ–‡æœ¬ä¸­ä¸¢å¤±äº†ç‰ˆæœ¬ç¼–å·ã€‚ ç¨åæˆ‘ä»¬å°†ä½¿ç”¨ JavaScript åŠ¨æ€æ’å…¥å®ƒä»¬ã€‚

### åœ¨çª—å£ä¸­æ‰“å¼€æ‚¨çš„é¡µé¢

ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªé¡µé¢ï¼Œå°†å®ƒåŠ è½½è¿›åº”ç”¨çª—å£ä¸­ã€‚ è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ éœ€è¦ ä¸¤ä¸ªElectronæ¨¡å—ï¼š

- [`app`](https://www.electronjs.org/zh/docs/latest/api/app) æ¨¡å—ï¼Œå®ƒæ§åˆ¶åº”ç”¨ç¨‹åºçš„äº‹ä»¶ç”Ÿå‘½å‘¨æœŸã€‚
- [`BrowserWindow`](https://www.electronjs.org/zh/docs/latest/api/browser-window) æ¨¡å—ï¼Œå®ƒåˆ›å»ºå’Œç®¡ç†åº”ç”¨ç¨‹åº çª—å£ã€‚

å› ä¸ºä¸»è¿›ç¨‹è¿è¡Œç€ Node.jsï¼Œæ‚¨å¯ä»¥åœ¨ main.js æ–‡ä»¶å¤´éƒ¨å°†å®ƒä»¬å¯¼å…¥ä½œä¸º [CommonJS](https://nodejs.org/docs/latest/api/modules.html#modules_modules_commonjs_modules) æ¨¡å—ï¼š

```js
const { app, BrowserWindow } = require('electron')
```



ç„¶åï¼Œæ·»åŠ ä¸€ä¸ª`createWindow()`æ–¹æ³•æ¥å°†`index.html`åŠ è½½è¿›ä¸€ä¸ªæ–°çš„`BrowserWindow`å®ä¾‹ã€‚

```js
const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600
  })

  win.loadFile('index.html')
}
```



æ¥ç€ï¼Œè°ƒç”¨`createWindow()`å‡½æ•°æ¥æ‰“å¼€æ‚¨çš„çª—å£ã€‚

åœ¨ Electron ä¸­ï¼Œåªæœ‰åœ¨ `app` æ¨¡å—çš„ [`ready`](https://www.electronjs.org/zh/docs/latest/api/app#event-ready) äº‹ä»¶è¢«æ¿€å‘åæ‰èƒ½åˆ›å»ºæµè§ˆå™¨çª—å£ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ [`app.whenReady()`](https://www.electronjs.org/zh/docs/latest/api/app#appwhenready) APIæ¥ç›‘å¬æ­¤äº‹ä»¶ã€‚ åœ¨`whenReady()`æˆåŠŸåè°ƒç”¨`createWindow()`ã€‚

```js
app.whenReady().then(() => {
  createWindow()
})
```



> æ³¨æ„ï¼šæ­¤æ—¶ï¼Œæ‚¨çš„ç”µå­åº”ç”¨ç¨‹åºåº”å½“æˆåŠŸ æ‰“å¼€æ˜¾ç¤ºæ‚¨é¡µé¢çš„çª—å£ï¼

### ç®¡ç†çª—å£çš„ç”Ÿå‘½å‘¨æœŸ

è™½ç„¶ä½ ç°åœ¨å¯ä»¥æ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œä½†ä½ è¿˜éœ€è¦ä¸€äº›é¢å¤–çš„æ¨¡æ¿ä»£ç ä½¿å…¶çœ‹èµ·æ¥æ›´åƒæ˜¯å„å¹³å°åŸç”Ÿçš„ã€‚ åº”ç”¨ç¨‹åºçª—å£åœ¨æ¯ä¸ªOSä¸‹æœ‰ä¸åŒçš„è¡Œä¸ºï¼ŒElectronå°†åœ¨appä¸­å®ç°è¿™äº›çº¦å®šçš„è´£ä»»äº¤ç»™å¼€å‘è€…ä»¬ã€‚

ä¸€èˆ¬è€Œè¨€ï¼Œä½ å¯ä»¥ä½¿ç”¨ `è¿›ç¨‹` å…¨å±€çš„ [`platform`](https://nodejs.org/api/process.html#process_process_platform) å±æ€§æ¥ä¸“é—¨ä¸ºæŸäº›æ“ä½œç³»ç»Ÿè¿è¡Œä»£ç ã€‚

#### å…³é—­æ‰€æœ‰çª—å£æ—¶é€€å‡ºåº”ç”¨ (Windows & Linux)

åœ¨Windowså’ŒLinuxä¸Šï¼Œå…³é—­æ‰€æœ‰çª—å£é€šå¸¸ä¼šå®Œå…¨é€€å‡ºä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œä½ éœ€è¦ç›‘å¬ `app` æ¨¡å—çš„ [`'window-all-closed'`](https://www.electronjs.org/zh/docs/latest/api/app#event-window-all-closed) äº‹ä»¶ã€‚å¦‚æœç”¨æˆ·ä¸æ˜¯åœ¨ macOS(`darwin`) ä¸Šè¿è¡Œç¨‹åºï¼Œåˆ™è°ƒç”¨ [`app.quit()`](https://www.electronjs.org/zh/docs/latest/api/app#appquit)ã€‚

```js
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') app.quit()
})
```



#### å¦‚æœæ²¡æœ‰çª—å£æ‰“å¼€åˆ™æ‰“å¼€ä¸€ä¸ªçª—å£ (macOS)

å½“ Linux å’Œ Windows åº”ç”¨åœ¨æ²¡æœ‰çª—å£æ‰“å¼€æ—¶é€€å‡ºäº†ï¼ŒmacOS åº”ç”¨é€šå¸¸å³ä½¿åœ¨æ²¡æœ‰æ‰“å¼€ä»»ä½•çª—å£çš„æƒ…å†µä¸‹ä¹Ÿç»§ç»­è¿è¡Œï¼Œå¹¶ä¸”åœ¨æ²¡æœ‰çª—å£å¯ç”¨çš„æƒ…å†µä¸‹æ¿€æ´»åº”ç”¨æ—¶ä¼šæ‰“å¼€æ–°çš„çª—å£ã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‰¹æ€§ï¼Œç›‘å¬ `app` æ¨¡å—çš„ [`activate`](https://www.electronjs.org/zh/docs/latest/api/app#event-activate-macos) äº‹ä»¶ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•æµè§ˆå™¨çª—å£æ˜¯æ‰“å¼€çš„ï¼Œåˆ™è°ƒç”¨ `createWindow()` æ–¹æ³•ã€‚

å› ä¸ºçª—å£æ— æ³•åœ¨ `ready` äº‹ä»¶å‰åˆ›å»ºï¼Œä½ åº”å½“åœ¨ä½ çš„åº”ç”¨åˆå§‹åŒ–åä»…ç›‘å¬ `activate` äº‹ä»¶ã€‚ é€šè¿‡åœ¨æ‚¨ç°æœ‰çš„ `whenReady()` å›è°ƒä¸­é™„ä¸Šæ‚¨çš„äº‹ä»¶ç›‘å¬å™¨æ¥å®Œæˆè¿™ä¸ªæ“ä½œã€‚

```js
app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) createWindow()
  })
})
```



> æ³¨æ„ï¼šæ­¤æ—¶ï¼Œæ‚¨çš„çª—å£æ§ä»¶åº”åŠŸèƒ½é½å…¨ï¼

### é€šè¿‡é¢„åŠ è½½è„šæœ¬ä»æ¸²æŸ“å™¨è®¿é—®Node.jsã€‚

ç°åœ¨ï¼Œæœ€åè¦åšçš„æ˜¯è¾“å‡ºElectronçš„ç‰ˆæœ¬å·å’Œå®ƒçš„ä¾èµ–é¡¹åˆ°ä½ çš„webé¡µé¢ä¸Šã€‚

åœ¨ä¸»è¿›ç¨‹é€šè¿‡Nodeçš„å…¨å±€ `process` å¯¹è±¡è®¿é—®è¿™ä¸ªä¿¡æ¯æ˜¯å¾®ä¸è¶³é“çš„ã€‚ ç„¶è€Œï¼Œä½ ä¸èƒ½ç›´æ¥åœ¨ä¸»è¿›ç¨‹ä¸­ç¼–è¾‘DOMï¼Œå› ä¸ºå®ƒæ— æ³•è®¿é—®æ¸²æŸ“å™¨ `æ–‡æ¡£` ä¸Šä¸‹æ–‡ã€‚ å®ƒä»¬å­˜åœ¨äºå®Œå…¨ä¸åŒçš„è¿›ç¨‹ï¼

> æ³¨æ„ï¼šå¦‚æœæ‚¨éœ€è¦æ›´æ·±å…¥åœ°äº†è§£Electronè¿›ç¨‹ï¼Œè¯·å‚é˜… [è¿›ç¨‹æ¨¡å‹](https://www.electronjs.org/zh/docs/latest/tutorial/process-model) æ–‡æ¡£ã€‚

è¿™æ˜¯å°† **é¢„åŠ è½½** è„šæœ¬è¿æ¥åˆ°æ¸²æŸ“å™¨æ—¶æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚ é¢„åŠ è½½è„šæœ¬åœ¨æ¸²æŸ“å™¨è¿›ç¨‹åŠ è½½ä¹‹å‰åŠ è½½ï¼Œå¹¶æœ‰æƒè®¿é—®ä¸¤ä¸ª æ¸²æŸ“å™¨å…¨å±€ (ä¾‹å¦‚ `window` å’Œ `document`) å’Œ Node.js ç¯å¢ƒã€‚

åˆ›å»ºä¸€ä¸ªåä¸º `preload.js` çš„æ–°è„šæœ¬å¦‚ä¸‹ï¼š

```js
window.addEventListener('DOMContentLoaded', () => {
  const replaceText = (selector, text) => {
    const element = document.getElementById(selector)
    if (element) element.innerText = text
  }

  for (const dependency of ['chrome', 'node', 'electron']) {
    replaceText(`${dependency}-version`, process.versions[dependency])
  }
})
```



ä¸Šé¢çš„ä»£ç è®¿é—® Node.js `process.versions` å¯¹è±¡ï¼Œå¹¶è¿è¡Œä¸€ä¸ªåŸºæœ¬çš„ `replaceText` è¾…åŠ©å‡½æ•°å°†ç‰ˆæœ¬å·æ’å…¥åˆ° HTML æ–‡æ¡£ä¸­ã€‚

è¦å°†æ­¤è„šæœ¬é™„åŠ åˆ°æ¸²æŸ“å™¨æµç¨‹ï¼Œè¯·åœ¨ä½ ç°æœ‰çš„ `BrowserWindow` æ„é€ å™¨ä¸­å°†è·¯å¾„ä¸­çš„é¢„åŠ è½½è„šæœ¬ä¼ å…¥ `webPreferences.preload` é€‰é¡¹ã€‚

```js
const { app, BrowserWindow } = require('electron')
// include the Node.js 'path' module at the top of your file
const path = require('node:path')

// modify your existing createWindow() function
const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  win.loadFile('index.html')
}
// ...
```



è¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªNode.jsæ¦‚å¿µï¼š

- [`__dirname`](https://nodejs.org/api/modules.html#modules_dirname) å­—ç¬¦ä¸²æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„è·¯å¾„ (åœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒæŒ‡å‘ä½ çš„é¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹)ã€‚
- [`path.join`](https://nodejs.org/api/path.html#path_path_join_paths) API å°†å¤šä¸ªè·¯å¾„è”ç»“åœ¨ä¸€èµ·ï¼Œåˆ›å»ºä¸€ä¸ªè·¨å¹³å°çš„è·¯å¾„å­—ç¬¦ä¸²ã€‚

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç›¸å¯¹å½“å‰æ­£åœ¨æ‰§è¡ŒJavaScriptæ–‡ä»¶çš„è·¯å¾„ï¼Œè¿™æ ·æ‚¨çš„ç›¸å¯¹è·¯å¾„å°†åœ¨å¼€å‘æ¨¡å¼å’Œæ‰“åŒ…æ¨¡å¼ä¸­éƒ½å°†æœ‰æ•ˆã€‚

### é¢å¤–ï¼šå°†åŠŸèƒ½æ·»åŠ åˆ°æ‚¨çš„ç½‘é¡µå†…å®¹

æ­¤åˆ»ï¼Œæ‚¨å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºæ·»åŠ æ›´å¤šåŠŸèƒ½ã€‚

å¯¹äºä¸æ‚¨çš„ç½‘é¡µå†…å®¹çš„ä»»ä½•äº¤äº’ï¼Œæ‚¨æƒ³è¦å°†è„šæœ¬æ·»åŠ åˆ°æ‚¨çš„æ¸²æŸ“å™¨è¿›ç¨‹ä¸­ã€‚ ç”±äºæ¸²æŸ“å™¨è¿è¡Œåœ¨æ­£å¸¸çš„ Web ç¯å¢ƒä¸­ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨ `index.html` æ–‡ä»¶å…³é—­ `</body>` æ ‡ç­¾ä¹‹å‰æ·»åŠ ä¸€ä¸ª `<script>` æ ‡ç­¾ï¼Œæ¥åŒ…æ‹¬æ‚¨æƒ³è¦çš„ä»»æ„è„šæœ¬ï¼š

```html
<script src="./renderer.js"></script>
```



`renderer.js` ä¸­åŒ…å«çš„ä»£ç å¯ä»¥åœ¨æ¥ä¸‹æ¥ä½¿ç”¨ä¸å‰ç«¯å¼€å‘ç›¸åŒçš„ JavaScript API å’Œå·¥å…·ã€‚ä¾‹å¦‚ä½¿ç”¨ [`webpack`](https://webpack.js.org/) æ‰“åŒ…å¹¶æœ€å°åŒ–æ‚¨çš„ä»£ç ï¼Œæˆ–è€…ä½¿ç”¨ [React](https://reactjs.org/) æ¥ç®¡ç†æ‚¨çš„ç”¨æˆ·ç•Œé¢ã€‚

### å›é¡¾

å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„Electronç¨‹åºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](img/simplest-electron-app-849f2d68df0c27475bfb850ed5d171a6.png)

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```js
// main.js

// Modules to control application life and create native browser window
const { app, BrowserWindow } = require('electron')
const path = require('node:path')

const createWindow = () => {
  // Create the browser window.
  const mainWindow = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  // åŠ è½½ index.html
  mainWindow.loadFile('index.html')

  // æ‰“å¼€å¼€å‘å·¥å…·
  // mainWindow.webContents.openDevTools()
}

// è¿™æ®µç¨‹åºå°†ä¼šåœ¨ Electron ç»“æŸåˆå§‹åŒ–
// å’Œåˆ›å»ºæµè§ˆå™¨çª—å£çš„æ—¶å€™è°ƒç”¨
// éƒ¨åˆ† API åœ¨ ready äº‹ä»¶è§¦å‘åæ‰èƒ½ä½¿ç”¨ã€‚
app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    // åœ¨ macOS ç³»ç»Ÿå†…, å¦‚æœæ²¡æœ‰å·²å¼€å¯çš„åº”ç”¨çª—å£
    // ç‚¹å‡»æ‰˜ç›˜å›¾æ ‡æ—¶é€šå¸¸ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çª—å£
    if (BrowserWindow.getAllWindows().length === 0) createWindow()
  })
})

// é™¤äº† macOS å¤–ï¼Œå½“æ‰€æœ‰çª—å£éƒ½è¢«å…³é—­çš„æ—¶å€™é€€å‡ºç¨‹åºã€‚ å› æ­¤, é€šå¸¸
// å¯¹åº”ç”¨ç¨‹åºå’Œå®ƒä»¬çš„èœå•æ æ¥è¯´åº”è¯¥æ—¶åˆ»ä¿æŒæ¿€æ´»çŠ¶æ€, 
// ç›´åˆ°ç”¨æˆ·ä½¿ç”¨ Cmd + Q æ˜ç¡®é€€å‡º
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') app.quit()
})

// åœ¨å½“å‰æ–‡ä»¶ä¸­ä½ å¯ä»¥å¼•å…¥æ‰€æœ‰çš„ä¸»è¿›ç¨‹ä»£ç 
// ä¹Ÿå¯ä»¥æ‹†åˆ†æˆå‡ ä¸ªæ–‡ä»¶ï¼Œç„¶åç”¨ require å¯¼å…¥ã€‚
```



```js
// preload.js

// æ‰€æœ‰çš„ Node.js APIæ¥å£ éƒ½å¯ä»¥åœ¨ preload è¿›ç¨‹ä¸­è¢«è°ƒç”¨.
// å®ƒæ‹¥æœ‰ä¸Chromeæ‰©å±•ä¸€æ ·çš„æ²™ç›’ã€‚
window.addEventListener('DOMContentLoaded', () => {
  const replaceText = (selector, text) => {
    const element = document.getElementById(selector)
    if (element) element.innerText = text
  }

  for (const dependency of ['chrome', 'node', 'electron']) {
    replaceText(`${dependency}-version`, process.versions[dependency])
  }
})
```



```html
<!--index.html-->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
    <title>ä½ å¥½!</title>
  </head>
  <body>
    <h1>ä½ å¥½!</h1>
    æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Node.js <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    å’Œ Electron <span id="electron-version"></span>.

    <ï¼-- æ‚¨ä¹Ÿå¯ä»¥æ­¤è¿›ç¨‹ä¸­è¿è¡Œå…¶ä»–æ–‡ä»¶ -->
    <script src="./renderer.js"></script>
  </body>
</html>
```



[DOCS/FIDDLES/QUICK-START (27.0.2)](https://github.com/electron/electron/tree/v27.0.2/docs/fiddles/quick-start)[Open in Fiddle](https://fiddle.electronjs.org/launch?target=electron/v27.0.2/docs/fiddles/quick-start)

- main.js
- preload.js
- index.html

```js
const { app, BrowserWindow } = require('electron')
const path = require('node:path')

function createWindow () {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  win.loadFile('index.html')
}

app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow()
    }
  })
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }
})
```



æ€»ç»“æˆ‘ä»¬æ‰€åšçš„æ‰€æœ‰æ­¥éª¤ï¼š

- æˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªNode.jsç¨‹åºï¼Œå¹¶å°†Electronæ·»åŠ ä¸ºä¾èµ–ã€‚
- æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª `main.js` è„šæœ¬æ¥è¿è¡Œæˆ‘ä»¬çš„ä¸»è¦è¿›ç¨‹ï¼Œå®ƒæ§åˆ¶æˆ‘ä»¬çš„åº”ç”¨ç¨‹åº å¹¶ä¸”åœ¨ Node.js ç¯å¢ƒä¸­è¿è¡Œã€‚ åœ¨æ­¤è„šæœ¬ä¸­ï¼Œ æˆ‘ä»¬ä½¿ç”¨ Electron çš„ `app` å’Œ `BrowserWindow` æ¨¡å—æ¥åˆ›å»ºä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œåœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹(æ¸²æŸ“å™¨)ä¸­æ˜¾ç¤ºç½‘é¡µå†…å®¹ã€‚
- ä¸ºäº†è®¿é—®æ¸²æŸ“å™¨ä¸­çš„Node.jsçš„æŸäº›åŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨ `BrowserWindow` çš„æ„é€ å‡½æ•°ä¸Šé™„åŠ äº†ä¸€ä¸ªé¢„åŠ è½½è„šæœ¬ã€‚

## æ‰“åŒ…å¹¶åˆ†å‘æ‚¨çš„åº”ç”¨ç¨‹åº

æœ€å¿«æ·çš„æ‰“åŒ…æ–¹å¼æ˜¯ä½¿ç”¨ [Electron Forge](https://www.electronforge.io/)ã€‚

1. å°† Electron Forge æ·»åŠ åˆ°æ‚¨åº”ç”¨çš„å¼€å‘ä¾èµ–ä¸­ï¼Œå¹¶ä½¿ç”¨å…¶"import"å‘½ä»¤è®¾ç½® Forge çš„è„šæ‰‹æ¶ï¼š

   - npm
   - Yarn

   ```sh
   npm install --save-dev @electron-forge/cli
   npx electron-forge import
   
   âœ” Checking your system
   âœ” Initializing Git Repository
   âœ” Writing modified package.json file
   âœ” Installing dependencies
   âœ” Writing modified package.json file
   âœ” Fixing .gitignore
   
   We have ATTEMPTED to convert your app to be in a format that electron-forge understands.
   
   Thanks for using "electron-forge"!!!
   ```

   

2. ä½¿ç”¨ Forge çš„ `make` å‘½ä»¤æ¥åˆ›å»ºå¯åˆ†å‘çš„åº”ç”¨ç¨‹åºï¼š

   - npm
   - Yarn

   ```sh
   npm run make
   
   > my-electron-app@1.0.0 make /my-electron-app
   > electron-forge make
   
   âœ” Checking your system
   âœ” Resolving Forge Config
   We need to package your application before we can make it
   âœ” Preparing to Package Application for arch: x64
   âœ” Preparing native dependencies
   âœ” Packaging Application
   Making for the following targets: zip
   âœ” Making for target: zip - On platform: darwin - For arch: x64
   ```

   

   Electron-forge ä¼šåˆ›å»º `out` æ–‡ä»¶å¤¹ï¼Œæ‚¨çš„è½¯ä»¶åŒ…å°†åœ¨é‚£é‡Œæ‰¾åˆ°ï¼š

   ```plain
   // Example for macOS
   out/
   â”œâ”€â”€ out/make/zip/darwin/x64/my-electron-app-darwin-x64-1.0.0.zip
   â”œâ”€â”€ ...
   â””â”€â”€ out/my-electron-app-darwin-x64/my-electron-app.app/Contents/MacOS/my-electron-app
   ```

   

# å®‰è£…æŒ‡å¯¼

è¦å®‰è£…é¢„ç¼–è¯‘çš„ Electron äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ [`npm`](https://docs.npmjs.com/)ã€‚ é¦–é€‰æ–¹æ³•æ˜¯åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­å®‰è£… Electron ä½œä¸ºå¼€å‘ä¾èµ–ï¼š

```sh
npm install electron --save-dev
```



æŸ¥çœ‹[versioning doc](https://www.electronjs.org/zh/docs/latest/tutorial/electron-versioning)è·å–å¦‚ä½•åœ¨ä½ çš„åº”ç”¨ä¸­ç®¡ç†Electronçš„ç›¸å…³ä¿¡æ¯ã€‚

## è¿è¡Œ Electron ad-hoc

å¦‚æœä½ ä¸æƒ³åœ¨æœ¬åœ°å·¥ç¨‹ä¸Šä½¿ç”¨ `npm install` åŒæ—¶åˆæ²¡ç”¨å…¶å®ƒé€‰æ‹©æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `npm` æ†ç»‘çš„ [`npx`](https://docs.npmjs.com/cli/v7/commands/npx) å‘½ä»¤æ¥è¿è¡Œ Electron ad-hocï¼š

```sh
npx electron .
```



ä¸Šé¢çš„å‘½ä»¤ä¼šåœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹è¿è¡ŒElectronã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ çš„åº”ç”¨ä¸­çš„ä»»ä½•ä¾èµ–å°†ä¸ä¼šè¢«å®‰è£…ã€‚

## è‡ªå®šä¹‰

å¦‚æœæƒ³ä¿®æ”¹ä¸‹è½½å®‰è£…çš„ä½ç‰ˆæœ¬(ä¾‹å¦‚, åœ¨`x64`æœºå™¨ä¸Šå®‰è£…`ia32`ä½ç‰ˆæœ¬), ä½ å¯ä»¥ä½¿ç”¨npm installä¸­çš„`--arch`æ ‡è®°ï¼Œæˆ–è€…è®¾ç½®`npm_config_arch` ç¯å¢ƒå˜é‡:

```shell
npm install --arch=ia32 electron
```



æ­¤å¤–, æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ `--platform` æ¥æŒ‡å®šå¼€å‘å¹³å° (ä¾‹å¦‚, `win32`ã€`linux` ç­‰):

```shell
npm install --platform=win32 electron
```



## ä»£ç†

å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨ HTTP ä»£ç†ï¼Œæ‚¨éœ€è¦è®¾ç½® `ELECTRON_GET_USE_PROXY` å˜é‡ä¸º ä»»ä½•å€¼ã€‚ é™„åŠ é¢å¤–çš„ç¯å¢ƒå˜é‡ï¼Œå–å†³äºæ‚¨çš„ä¸»æœºç³»ç»ŸNodeç‰ˆæœ¬ï¼š

- [Node10åŠä»¥ä¸Š](https://github.com/gajus/global-agent/blob/v2.1.5/README.md#environment-variables)
- [Node10å‰](https://github.com/np-maintain/global-tunnel/blob/v2.7.1/README.md#auto-config)

## è‡ªå®šä¹‰é•œåƒå’Œç¼“å­˜

åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œ`electron` æ¨¡å—ä¼šé€šè¿‡ [`electron-download`](https://github.com/electron/get) ä¸ºæ‚¨çš„å¹³å°ä¸‹è½½ Electron çš„é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ è¿™å°†é€šè¿‡è®¿é—® GitHub çš„å‘å¸ƒä¸‹è½½é¡µé¢æ¥å®Œæˆ (`https://github.com/electron/electron/releases/tag/v$VERSION`, è¿™é‡Œçš„ `$VERSION` æ˜¯ Electron çš„ç¡®åˆ‡ç‰ˆæœ¬).

å¦‚æœæ‚¨æ— æ³•è®¿é—®GitHubï¼Œæˆ–è€…æ‚¨éœ€è¦æä¾›è‡ªå®šä¹‰æ„å»ºï¼Œåˆ™å¯ä»¥é€šè¿‡æä¾›é•œåƒæˆ–ç°æœ‰çš„ç¼“å­˜ç›®å½•æ¥å®ç°ã€‚

#### é•œåƒ

æ‚¨å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥è¦†ç›–åŸºæœ¬ URLï¼ŒæŸ¥æ‰¾ Electron äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶åã€‚ `electron/get` ä½¿ç”¨çš„ç½‘å€ç»„æˆå¦‚ä¸‹ï¼š

```javascript
url = ELECTRON_MIRROR + ELECTRON_CUSTOM_DIR + '/' + ELECTRON_CUSTOM_FILENAME
```



ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ªä¸­å›½çš„é•œåƒï¼š

```shell
ELECTRON_MIRROR="https://npmmirror.com/mirrors/electron/"
```



é»˜è®¤æƒ…å†µä¸‹ï¼Œ`ELECTRON_CUSTTOM_DIR`è¢«è®¾ç½®ä¸º `v$VERSION`ã€‚ è¦æ›´æ”¹æ ¼å¼ï¼Œè¯·ä½¿ç”¨ `{{ version }}` å ä½ç¬¦ã€‚ ä¾‹å¦‚ï¼Œ`version-{{ version }}` è¢«è§£æä¸º `version-5.0.0`, `{{ version }}` è¢«è§£æä¸º `5.0.0`ï¼Œ `v{{ version }}` ä¸é»˜è®¤å€¼ç­‰ä»·ã€‚ æ›´å…·ä½“çš„ä¾‹å­ï¼Œä½¿ç”¨ä¸­å›½éCDNé•œåƒï¼š

```shell
ELECTRON_MIRROR="https://npmmirror.com/mirrors/electron/"
ELECTRON_CUSTOM_DIR="{{ version }}"
```



ä¸Šè¿°é…ç½®å°†ä»ç±»ä¼¼äº `https://npmmirror.com/mirrors/electron/8.0.0/electron-v8.0.0-linux-x64.zip` è¿™æ ·çš„ç½‘å€ä¸‹è½½ã€‚

å¦‚æœæ‚¨çš„é•œåƒåœ¨å®˜æ–¹ Electron ç‰ˆæœ¬ä¸­æä¾›ä¸åŒæ ¡éªŒå’Œï¼Œä½ å¯èƒ½å¿…é¡»å°† `electron_use_remote_checksums=1` è®¾ç½®ä¸º Electron ä½¿ç”¨è¿œç¨‹ `SHASUMS256.txt` æ–‡ä»¶æ¥éªŒè¯æ ¡éªŒå’Œ è€Œä¸æ˜¯åµŒå…¥æ ¡éªŒå’Œã€‚

#### ç¼“å­˜

æˆ–è€…ï¼Œæ‚¨å¯ä»¥è¦†ç›–æœ¬åœ°ç¼“å­˜ã€‚ `electron-download` ä¼šå°†ä¸‹è½½çš„äºŒè¿›åˆ¶æ–‡ä»¶ç¼“å­˜åœ¨æœ¬åœ°ç›®å½•ä¸­ï¼Œä¸ä¼šå¢åŠ ç½‘ç»œè´Ÿæ‹…ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è¯¥ç¼“å­˜æ–‡ä»¶å¤¹æ¥æä¾› Electron çš„å®šåˆ¶ç‰ˆæœ¬ï¼Œæˆ–è€…é¿å…è¿›è¡Œç½‘ç»œè¿æ¥ã€‚

- Linux: `$XDG_CACHE_HOME` or `~/.cache/electron/`
- macOS: `~/Library/Caches/electron/`
- Windows: `$LOCALAPPDATA/electron/Cache` or `~/AppData/Local/electron/Cache/`

åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬ Electron çš„ç¯å¢ƒä¸­ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨`~/.electron`ä¸­æ‰¾åˆ°ç¼“å­˜ã€‚

æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ª `electron_config_cache` ç¯å¢ƒå˜é‡æ¥è¦†ç›–æœ¬åœ°ç¼“å­˜ä½ç½®ã€‚

ç¼“å­˜ä¸­åŒ…å«äº†ä¸åŒç‰ˆæœ¬çš„å®˜æ–¹ zip æ–‡ä»¶ä»¥åŠæ ¡éªŒä¿¡æ¯ï¼Œä»¥ `[checksum]/[filename]` æ ¼å¼å­˜å‚¨ã€‚ å…¸å‹çš„ç¼“å­˜å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```sh
â”œâ”€â”€ a91b089b5dc5b1279966511344b805ec84869b6cd60af44f800b363bba25b915
â”‚   â””â”€â”€ electron-v15.3.1-darwin-x64.zip
```



## è·³è¿‡äºŒè¿›åˆ¶åŒ…ä¸‹è½½

åœ¨åº•å±‚, Electron çš„ JavaScript API ç»‘å®šäº†åŒ…å«é»˜è®¤å®ç°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ç”±äºæ­¤äºŒè¿›åˆ¶æ–‡ä»¶å¯¹äºä»»ä½• Electron åº”ç”¨çš„åŠŸèƒ½éƒ½è‡³å…³é‡è¦ï¼Œå› æ­¤æ¯æ¬¡å½“ä½ ä» npm æ³¨å†Œè¡¨å®‰è£… `electron` æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹éƒ½ä¼šåœ¨ `postinstall` æ­¥éª¤ä¸­ä¸‹è½½è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦å®‰è£…ä½ çš„é¡¹ç›®ä¾èµ–ï¼Œä½†ä¸éœ€è¦ä½¿ç”¨ Electron åŠŸèƒ½ã€‚ ä½ å¯ä»¥è®¾ç½® `ELECTRON_SKIP_BINARY_DOWNLOAD` ç¯å¢ƒå˜é‡æ¥é˜»æ­¢äºŒè¿›åˆ¶æ–‡ä»¶è¢«ä¸‹è½½ã€‚ ä¾‹å¦‚ï¼Œåœ¨è¿è¡Œæ¨¡æ‹Ÿ `electron` æ¨¡å—çš„å•å…ƒæµ‹è¯•æ—¶ï¼Œæ­¤åŠŸèƒ½åœ¨è¿ç»­é›†æˆç¯å¢ƒä¸­å¾ˆæœ‰ç”¨ã€‚

- npm
- Yarn

```sh
ELECTRON_SKIP_BINARY_DOWNLOAD=1 npm install
```



## æ•…éšœæ’æŸ¥

åœ¨è¿è¡Œ `npm install electron` æ—¶ï¼Œæœ‰äº›ç”¨æˆ·ä¼šå¶å°”é‡åˆ°å®‰è£…é—®é¢˜ã€‚

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›é”™è¯¯éƒ½æ˜¯ç”±ç½‘ç»œé—®é¢˜å¯¼è‡´ï¼Œè€Œä¸æ˜¯å› ä¸º `electron` npm åŒ…çš„é—®é¢˜ã€‚ å¦‚ `ELIFECYCLE`ã€`EAI_AGAIN`ã€`ECONNRESET` å’Œ `ETIMEDOUT` ç­‰é”™è¯¯éƒ½æ˜¯æ­¤ç±»ç½‘ç»œé—®é¢˜çš„æ ‡å¿—ã€‚ æœ€ä½³çš„è§£å†³æ–¹æ³•æ˜¯å°è¯•åˆ‡æ¢ç½‘ç»œï¼Œæˆ–æ˜¯ç¨åå†å°è¯•å®‰è£…ã€‚

å¦‚æœé€šè¿‡ `npm` å®‰è£…å¤±è´¥ï¼Œä½ ä¹Ÿå¯ä»¥å°è¯•é€šè¿‡ä» [electron/electron/release](https://github.com/electron/electron/releases) ç›´æ¥ä¸‹è½½ Electron

å¦‚æœå®‰è£…å¤±è´¥å¹¶æŠ¥é”™`EACCESS`ï¼Œæ‚¨å¯èƒ½éœ€è¦[ä¿®å¤npmæƒé™](https://docs.npmjs.com/getting-started/fixing-npm-permissions)ã€‚

å¦‚æœä¸Šè¿°æŠ¥é”™æŒç»­å‡ºç°ï¼Œ[unsafe-perm](https://docs.npmjs.com/misc/config#unsafe-perm) æ ‡å¿—å¯èƒ½éœ€è¦è¢«è®¾ç½®ä¸º true:

```sh
sudo npm install electron --unsafe-perm=true
```



åœ¨è¾ƒæ…¢çš„ç½‘ç»œä¸Š, æœ€å¥½ä½¿ç”¨ `--verbose `æ ‡å¿—æ¥æ˜¾ç¤ºä¸‹è½½è¿›åº¦:

```sh
npm install --verbose electron
```



å¦‚æœéœ€è¦å¼ºåˆ¶é‡æ–°ä¸‹è½½æ–‡ä»¶, å¹¶ä¸” SHASUM æ–‡ä»¶å°† `force_no_cache` ç¯å¢ƒå˜é‡è®¾ç½®ä¸º `true`ã€‚

# åŸºæœ¬è¦æ±‚

æ•™ç¨‹ç›®å½•

è¿™æ˜¯ Electron æ•™ç¨‹çš„**ç¬¬ 1 éƒ¨åˆ†** ã€‚

1. **[åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)**
2. [åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)
3. [ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)
4. [æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)
5. [æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)
6. [å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)

Electronæ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScriptã€HTML å’Œ CSS æ„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ Electron å°† [Chromium](https://www.chromium.org/) å’Œ [Node.js](https://nodejs.org/) åµŒå…¥åˆ°äº†ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œå› æ­¤å®ƒå…è®¸ä½ ä»…éœ€ä¸€ä¸ªä»£ç ä»“åº“ï¼Œå°±å¯ä»¥æ’°å†™æ”¯æŒ Windowsã€macOS å’Œ Linux çš„è·¨å¹³å°åº”ç”¨ã€‚

æœ¬æ•™ç¨‹å°†æŒ‡å¯¼æ‚¨ä½¿ç”¨ Electron å¼€å‘ä¸€ä¸ªæ¡Œé¢åº”ç”¨ï¼Œå¹¶å°†å…¶åˆ†å‘ç»™ç»ˆç«¯ç”¨æˆ·ã€‚

## ç›®æ ‡

æœ¬æ•™ç¨‹é¦–å…ˆæŒ‡å¯¼æ‚¨å®Œæˆä»å¤´å¼€å§‹æ‹¼å‡‘ä¸€ä¸ªæœ€å°çš„ Electron åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ï¼Œç„¶åæ•™æ‚¨å¦‚ä½•ä½¿ç”¨ Electron Forge æ‰“åŒ…å¹¶å°†å…¶åˆ†å‘ç»™ç”¨æˆ·ã€‚

å¦‚æœæ‚¨å¸Œæœ›ä»å•å‘½ä»¤æ ·æ¿å¼€å§‹é¡¹ç›®ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨ä½¿ç”¨ Electron Forge çš„ [`create-electron-app`](https://www.electronforge.io/) å‘½ä»¤ã€‚

## å‰è¨€

Electron æ˜¯ç½‘é¡µåº”ç”¨ (web apps) çš„ä¸€ä¸ªåŸç”ŸåŒ…è£…å±‚ï¼Œåœ¨ Node.js ç¯å¢ƒä¸­è¿è¡Œã€‚ å› æ­¤ï¼Œæœ¬æ•™ç¨‹å‡è®¾æ‚¨å·²ç»å¯¹ Node.js å’Œå‰ç«¯ Web å¼€å‘æœ‰ä¸€å®šåœ°äº†è§£ã€‚ å¦‚æœæ‚¨è¿˜éœ€è¦äº†è§£ä¸€äº›èƒŒæ™¯çŸ¥è¯†ï¼Œæˆ‘ä»¬æ¨èæ‚¨é˜…è¯»ï¼š

- [Web å…¥é—¨ (MDN Web Docs)](https://developer.mozilla.org/en-US/docs/Learn/)
- [NodeJSå®˜æ–¹å…¥é—¨æŒ‡å—](https://nodejs.dev/en/learn/)

## æ‰€éœ€å·¥å…·

### ä»£ç ç¼–è¾‘å™¨

æ‚¨éœ€è¦ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨æ¥ç¼–å†™ä»£ç ã€‚ æˆ‘ä»¬å»ºè®®ä½¿ç”¨ [Visual Studio Code](https://code.visualstudio.com/)ï¼Œ æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„ä»»ä½•ä¸€ä¸ªã€‚

### å‘½ä»¤è¡Œå·¥å…·

åœ¨æ•´ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è¦æ±‚æ‚¨ä½¿ç”¨å„ç§å‘½ä»¤è¡Œæ¥å£ (CLI) ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ç³»ç»Ÿçš„é»˜è®¤å‘½ä»¤è¡Œå·¥å…·ï¼š

- Windows: å‘½ä»¤æç¤ºç¬¦ / PowerShell
- macOS: Terminal
- Linux: è§†å‘è¡Œç‰ˆå†³å®š (å¦‚ GNOME ç»ˆç«¯ Konsole)

å¤§å¤šæ•°ä»£ç ç¼–è¾‘å™¨ä¹Ÿå†…ç½®äº†ç»ˆç«¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚

### Git å’Œ GitHub

Git æ˜¯å¸¸ç”¨çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ŒGitHub æ˜¯ä¸€ä¸ªåŸºäºå®ƒçš„åä½œå¼€å‘å¹³å°ã€‚ è™½ç„¶å®ƒä»¬å¯¹å¼€å‘ Electron åº”ç”¨è€Œè¨€ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†æˆ‘ä»¬åœ¨åç»­æ•™ç¨‹ä¸­ä¼šä½¿ç”¨ GitHub Releases æ¥å®ç°è½¯ä»¶çš„è‡ªåŠ¨æ›´æ–°ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨ï¼š

- [åˆ›å»ºä¸€ä¸ª GitHub è´¦å·](https://github.com/join)
- [å®‰è£… Git](https://github.com/git-guides/install-git)

å¦‚æœæ‚¨å¯¹ Git è¿˜ä¸ç†Ÿæ‚‰ï¼Œæˆ‘ä»¬æ¨èé˜…è¯» GitHub çš„ [Git æŒ‡å—](https://github.com/git-guides/) ã€‚ å¦‚æœæ‚¨å–œæ¬¢å¯è§†åŒ–ç•Œé¢è€Œä¸æ˜¯å‘½ä»¤è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ [GitHub Desktop](https://desktop.github.com/) ã€‚

æˆ‘ä»¬å»ºè®®æ‚¨åˆ›å»ºä¸€ä¸ªæœ¬åœ° Git ä»“åº“ï¼Œåœ¨é˜…è¯»æ•™ç¨‹ä¹‹å‰å°†å…¶æ¨é€åˆ° GitHubï¼Œå¹¶ä¸”åœ¨å®Œæˆæ•™ç¨‹å„ä¸ªæ­¥éª¤åå°†ä»£ç æäº¤ä¸Šå»ã€‚

é€šè¿‡ GITHUB DESKTOP å®‰è£… GIT

å¦‚æœæ‚¨çš„æ“ä½œç³»ç»Ÿä¸­æ²¡æœ‰å®‰è£… Gitï¼ŒGitHub Desktop ä¼šè‡ªåŠ¨å¸®æ‚¨å®‰è£… Git æœ€æ–°ç‰ˆæœ¬ã€‚

### Node.js å’Œ npm

è¦å¼€å‘ Electron åº”ç”¨ï¼Œæ‚¨éœ€è¦å®‰è£… [Node.js](https://nodejs.org/en/download/) è¿è¡Œç¯å¢ƒå’Œå®ƒçš„åŒ…ç®¡ç†å™¨ npmã€‚ æˆ‘ä»¬æ¨èå®‰è£…æœ€æ–°çš„é•¿æœŸæ”¯æŒ (LTS) ç‰ˆæœ¬ã€‚

æç¤º

è¯·ä½¿ç”¨ä¸ºä½ å¹³å°é¢„æ„å»ºçš„ Node.js å®‰è£…å™¨æ¥è¿›è¡Œå®‰è£…ï¼Œ å¦åˆ™ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°ä¸ä¸åŒå¼€å‘å·¥å…·ä¸å…¼å®¹çš„é—®é¢˜ã€‚ å¦‚æœæ‚¨ä½¿ç”¨ macOSï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨å¦‚ [Homebrew](https://brew.sh/) æˆ– [nvm](https://github.com/nvm-sh/nvm) è¿™æ ·çš„åŒ…ç®¡ç†å™¨ï¼Œæ¥é¿å¼€è¯»å†™ç›®å½•æƒé™é—®é¢˜ã€‚

è¦æ£€æŸ¥ Node.js æ˜¯å¦å·²è¢«å®‰è£…ï¼Œæ‚¨å¯ä»¥åœ¨è¿è¡Œ `node` å’Œ `npm` å‘½ä»¤æ—¶ï¼ŒåŠ ä¸Š `-v` å‚æ•°ã€‚ å¦‚æœå·²å®‰è£…ï¼Œå®ƒä»¬åº”å½“ä¼šè¾“å‡ºå¯¹åº”çš„ç‰ˆæœ¬ã€‚

```sh
$ node -v
v16.14.2
$ npm -v
8.7.0
```



æ³¨æ„äº‹é¡¹

è™½ç„¶æ‚¨éœ€è¦åœ¨å¼€å‘ç¯å¢ƒå®‰è£… Node.js æ‰èƒ½ç¼–å†™ Electron é¡¹ç›®ï¼Œä½†æ˜¯ Electron **ä¸ä½¿ç”¨æ‚¨ç³»ç»Ÿçš„ Node.js ç¯å¢ƒæ¥è¿è¡Œå®ƒçš„ä»£ç **ã€‚ ç›¸ååœ°ï¼Œå®ƒä½¿ç”¨å®ƒå†…ç½®çš„ Node.js è¿è¡Œæ—¶ã€‚ è¿™æ„å‘³ç€æ‚¨çš„ç»ˆç«¯ç”¨æˆ·ä¸éœ€è¦ Node.js ç¯å¢ƒä¹Ÿå¯ä»¥è¿è¡Œæ‚¨çš„åº”ç”¨ã€‚

è¦æŸ¥çœ‹æ‚¨åº”ç”¨å†…ç½®çš„ Node.js ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥è®¿é—®ä¸»è¿›ç¨‹ (main process) æˆ–é¢„åŠ è½½è„šæœ¬ (preload script) ä¸­çš„ [`process.versions`](https://nodejs.org/api/process.html#processversions) å˜é‡ã€‚ æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒhttps://releases.electronjs.org/releases.jsonã€‚

# åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº

æ•™ç¨‹ç›®å½•

è¿™æ˜¯ Electron æ•™ç¨‹çš„**ç¬¬äºŒéƒ¨åˆ†**ã€‚

1. [åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)
2. **[åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)**
3. [ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)
4. [æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)
5. [æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)
6. [å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)

## å­¦ä¹ ç›®æ ‡

åœ¨æœ¬èŠ‚ï¼Œæ‚¨ä¼šå­¦ä¹ å¦‚ä½•åˆ›å»ºæ‚¨çš„ Electron é¡¹ç›®ï¼Œå¹¶ä¸”ç¼–å†™ä¸€ä¸ªç®€å•çš„å…¥é—¨ç¨‹åºã€‚ åˆ°äº†æœ¬èŠ‚æœ«å°¾ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨ç»ˆç«¯å¼€å‘ç¯å¢ƒè¿è¡Œä¸€ä¸ª Electron åº”ç”¨ã€‚

## åˆ›å»ºé¡¹ç›®

é¿å…ä½¿ç”¨ WSL

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Windowsç³»ç»Ÿï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­è¯·ä¸è¦ä½¿ç”¨ [Windows Subsystem for Linux](https://learn.microsoft.com/en-us/windows/wsl/about#what-is-wsl-2) (WSL)ï¼Œå¦åˆ™æ‚¨åœ¨å°è¯•è¿è¡Œåº”ç”¨æ—¶å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚

### åˆå§‹åŒ– npm é¡¹ç›®

Electron åº”ç”¨åŸºäº npm æ­å»ºï¼Œä»¥ package.json æ–‡ä»¶ä½œä¸ºå…¥å£ç‚¹ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶ä¸­æ‰§è¡Œ `npm init` åˆå§‹åŒ–é¡¹ç›®ã€‚

- npm
- Yarn

```sh
mkdir my-electron-app && cd my-electron-app
npm init
```



è¿™æ¡å‘½ä»¤ä¼šå¸®æ‚¨é…ç½® package.json ä¸­çš„ä¸€äº›å­—æ®µã€‚ ä¸ºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæœ‰å‡ æ¡è§„åˆ™éœ€è¦éµå¾ªï¼š

- *å…¥å£ç‚¹* åº”å½“æ˜¯ `main.js` (æ‚¨å¾ˆå¿«å°±ä¼šåˆ›å»ºå®ƒ)
- *author*ã€*license* å’Œ *description*å¯ä¸ºä»»æ„å€¼ï¼Œä½†å¯¹äº [åº”ç”¨æ‰“åŒ…](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹) æ˜¯å¿…å¡«é¡¹ã€‚

ç„¶åï¼Œå°† Electron å®‰è£…ä¸ºæ‚¨é¡¹ç›®çš„ **devDependencies**ï¼Œå³ä»…åœ¨å¼€å‘ç¯å¢ƒéœ€è¦çš„é¢å¤–ä¾èµ–ã€‚

ä¸ºä»€ä¹ˆ ELECTRON æ˜¯ DEVDEPENDENCY?

æ‚¨çš„åº”ç”¨éœ€è¦è¿è¡Œ Electron APIï¼Œå› æ­¤è¿™å¬ä¸Šå»å¯èƒ½æœ‰ç‚¹åç›´è§‰ã€‚ å®é™…ä¸Šï¼Œæ‰“åŒ…åçš„åº”ç”¨æœ¬èº«ä¼šåŒ…å« Electron çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤ä¸éœ€è¦å°† Electron ä½œä¸ºç”Ÿäº§ç¯å¢ƒä¾èµ–ã€‚

- npm
- Yarn

```sh
npm install electron --save-dev
```



åœ¨åˆå§‹åŒ–å¹¶ä¸”å®‰è£…å®Œ Electron ä¹‹åï¼Œæ‚¨çš„ package.json åº”è¯¥é•¿ä¸‹é¢è¿™æ ·ã€‚ æ–‡ä»¶å¤¹ä¸­ä¼šå‡ºç°ä¸€ä¸ª `node_modules` æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«äº† Electron å¯æ‰§è¡Œæ–‡ä»¶ï¼›è¿˜æœ‰ä¸€ä¸ª `package-lock.json` æ–‡ä»¶ï¼ŒæŒ‡å®šäº†å„ä¸ªä¾èµ–çš„ç¡®åˆ‡ç‰ˆæœ¬ã€‚

package.json

```json
{
  "name": "my-electron-app",
  "version": "1.0.0",
  "description": "Hello World!",
  "main": "main.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Jane Doe",
  "license": "MIT",
  "devDependencies": {
    "electron": "23.1.3"
  }
}
```



é«˜çº§å®‰è£…æ­¥éª¤

å¦‚æœç›´æ¥å®‰è£… Electron å¤±è´¥ï¼Œè¯·å‚è€ƒæˆ‘ä»¬çš„ [å®‰è£…æŒ‡å¯¼](https://www.electronjs.org/zh/docs/latest/tutorial/installation) æ–‡æ¡£ï¼Œäº†è§£æœ‰å…³ä¸‹è½½é•œåƒã€ä»£ç†å’Œæ•…éšœæ’é™¤æ­¥éª¤çš„è¯´æ˜ã€‚

### æ·»åŠ  .gitignore æ–‡ä»¶

[`.gitignore`](https://git-scm.com/docs/gitignore) æ–‡ä»¶å¯ä»¥æŒ‡å®šå“ªäº›æ–‡ä»¶å’Œç›®å½•åº”è¯¥åœ¨Gitä¸­ä¸è¢«è·Ÿè¸ªã€‚ å»ºè®®æ‚¨å¤åˆ¶ä¸€ä»½ [GitHub çš„ Node.js gitignore æ¨¡æ¿](https://github.com/github/gitignore/blob/main/Node.gitignore) åˆ°æ‚¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œä»¥é¿å…å°† `node_modules` æ–‡ä»¶å¤¹æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ã€‚

## è¿è¡Œ Electron åº”ç”¨

:::å»¶ä¼¸é˜…è¯»

å‚é˜… [Electron è¿›ç¨‹æ¨¡å‹ï¼ˆprocess modelï¼‰](https://www.electronjs.org/zh/docs/latest/tutorial/process-model) ç›¸å…³æ–‡æ¡£æ¥äº†è§£ Electron çš„è¿›ç¨‹ä¹‹é—´æ˜¯å¦‚ä½•åä½œçš„ã€‚

:::

æ‚¨åœ¨ package.json ä¸­æŒ‡å®šçš„ [`main`](https://docs.npmjs.com/cli/v7/configuring-npm/package-json#main) æ–‡ä»¶æ˜¯ Electron åº”ç”¨çš„å…¥å£ã€‚ è¿™ä¸ªæ–‡ä»¶æ§åˆ¶ **ä¸»ç¨‹åº (main process)**ï¼Œå®ƒè¿è¡Œåœ¨ Node.js ç¯å¢ƒé‡Œï¼Œè´Ÿè´£æ§åˆ¶æ‚¨åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€æ˜¾ç¤ºåŸç”Ÿç•Œé¢ã€æ‰§è¡Œç‰¹æ®Šæ“ä½œå¹¶ç®¡ç†æ¸²æŸ“å™¨è¿›ç¨‹ (renderer processes)ï¼Œç¨åä¼šè¯¦ç»†ä»‹ç»ã€‚

åœ¨ç»§ç»­ç¼–å†™æ‚¨çš„ Electron åº”ç”¨ä¹‹å‰ï¼Œæ‚¨å°†ä½¿ç”¨ä¸€ä¸ªå°å°çš„è„šæœ¬æ¥ç¡®ä¿ä¸»è¿›ç¨‹å…¥å£ç‚¹å·²ç»é…ç½®æ­£ç¡®ã€‚ åœ¨æ ¹ç›®å½•çš„ `main.js` æ–‡ä»¶ä¸­å†™ä¸€è¡Œä»£ç ï¼š

main.js

```js
console.log('Hello from Electron ğŸ‘‹')
```



ç”±äº Electron çš„ä¸»è¿›ç¨‹æ˜¯ä¸€ä¸ª Node.js è¿è¡Œæ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `electron` å‘½ä»¤æ‰§è¡Œä»»æ„çš„ Node.js ä»£ç  (ç”šè‡³å¯ä»¥å°†å…¶ä½œä¸º [REPL](https://www.electronjs.org/zh/docs/latest/tutorial/repl) ä½¿ç”¨)ã€‚ è¦æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œéœ€è¦åœ¨ package.json çš„ [`scripts`](https://docs.npmjs.com/cli/v7/using-npm/scripts) å­—æ®µä¸­æ·»åŠ ä¸€ä¸ª `start` å‘½ä»¤ï¼Œå†…å®¹ä¸º `electron .` ã€‚ è¿™ä¸ªå‘½ä»¤ä¼šå‘Šè¯‰ Electron åœ¨å½“å‰ç›®å½•ä¸‹å¯»æ‰¾ä¸»è„šæœ¬ï¼Œå¹¶ä»¥å¼€å‘æ¨¡å¼è¿è¡Œå®ƒã€‚

package.json

```json
{
  "name": "my-electron-app",
  "version": "1.0.0",
  "description": "Hello World!",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Jane Doe",
  "license": "MIT",
  "devDependencies": {
    "electron": "23.1.3"
  }
}
```

- npm
- Yarn

```sh
npm run start
```



æ‚¨çš„ç»ˆç«¯åº”è¯¥ä¼šè¾“å‡º `æ¬¢è¿æ¥åˆ° Electron ğŸ‘‹`ã€‚ æ­å–œï¼Œæ‚¨å·²ç»åœ¨ Electron ä¸­æ‰§è¡Œäº†æ‚¨çš„ç¬¬ä¸€è¡Œä»£ç ï¼ æ¥ä¸‹æ¥ï¼Œæ‚¨ä¼šå­¦ä¹ å¦‚ä½•ç”¨ HTML åˆ›å»ºç”¨æˆ·ç•Œé¢ï¼Œå¹¶å°†å®ƒä»¬è£…è½½åˆ°åŸç”Ÿçª—å£ä¸­ã€‚

## å°†ç½‘é¡µè£…è½½åˆ° BrowserWindow

åœ¨ Electron ä¸­ï¼Œæ¯ä¸ªçª—å£å±•ç¤ºä¸€ä¸ªé¡µé¢ï¼Œåè€…å¯ä»¥æ¥è‡ªæœ¬åœ°çš„ HTMLï¼Œä¹Ÿå¯ä»¥æ¥è‡ªè¿œç¨‹ URLã€‚ åœ¨æœ¬ä¾‹ä¸­ï¼Œæ‚¨å°†ä¼šè£…è½½æœ¬åœ°çš„æ–‡ä»¶ã€‚ åœ¨æ‚¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª `index.html` æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸‹é¢çš„å†…å®¹ï¼š

index.html

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <title>Hello from Electron renderer!</title>
  </head>
  <body>
    <h1>Hello from Electron renderer!</h1>
    <p>ğŸ‘‹</p>
  </body>
</html>
```



ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªç½‘é¡µï¼Œæ‚¨å¯ä»¥å°†å…¶åŠ è½½åˆ°ä¸€ä¸ª Electron çš„ [BrowserWindow](https://www.electronjs.org/zh/docs/latest/api/browser-window) ä¸Šäº†ã€‚ å°† `main.js` ä¸­çš„å†…å®¹æ›¿æ¢æˆä¸‹åˆ—ä»£ç ã€‚ æˆ‘ä»¬é©¬ä¸Šä¼šé€è¡Œè§£é‡Šã€‚

main.js

```js
const { app, BrowserWindow } = require('electron')

const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600
  })

  win.loadFile('index.html')
}

app.whenReady().then(() => {
  createWindow()
})
```



### å¯¼å…¥æ¨¡å—

main.js (Line 1)

```js
const { app, BrowserWindow } = require('electron')
```



åœ¨ç¬¬ä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ CommonJS è¯­æ³•å¯¼å…¥äº†ä¸¤ä¸ª Electron æ¨¡å—ï¼š

- [app](https://www.electronjs.org/zh/docs/latest/api/app)ï¼Œå®ƒç€æ‚¨åº”ç”¨ç¨‹åºçš„äº‹ä»¶ç”Ÿå‘½å‘¨æœŸã€‚
- [BrowserWindow](https://www.electronjs.org/zh/docs/latest/api/browser-window)ï¼Œå®ƒè´Ÿè´£åˆ›å»ºå’Œç®¡ç†åº”ç”¨çª—å£ã€‚

<details class="details_lb9f isBrowser_bmU9 alert alert--info details_b_Ee" data-collapsed="true" style="box-sizing: border-box; color: var(--ifm-alert-foreground-color); --ifm-alert-background-color: var(--ifm-color-info-contrast-background); --ifm-alert-background-color-highlight: #54c7ec26; --ifm-alert-foreground-color: var(--ifm-color-info-contrast-foreground); --ifm-alert-border-color: var(--ifm-color-info-dark); --ifm-code-background: var(--ifm-alert-background-color-highlight); --ifm-link-color: var(--ifm-alert-foreground-color); --ifm-link-hover-color: var(--ifm-alert-foreground-color); --ifm-link-decoration: underline; --ifm-tabs-color: var(--ifm-alert-foreground-color); --ifm-tabs-color-active: var(--ifm-alert-foreground-color); --ifm-tabs-color-active-border: var(--ifm-alert-border-color); background-color: var(--ifm-alert-background-color); border: 1px solid var(--ifm-alert-border-color); border-radius: var(--ifm-alert-border-radius); box-shadow: var(--ifm-alert-shadow); padding: var(--ifm-alert-padding-vertical) var(--ifm-alert-padding-horizontal); --docusaurus-details-summary-arrow-size: 0.38rem; --docusaurus-details-transition: transform var(--ifm-transition-fast) ease; --docusaurus-details-decoration-color: var(--ifm-alert-border-color); margin: 0 0 var(--ifm-spacing-vertical); font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, Ubuntu, Cantarell, &quot;Noto Sans&quot;, sans-serif, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="box-sizing: border-box; font-weight: 700; cursor: pointer; list-style: none; padding-left: 1rem; position: relative;">Module capitalization conventions</summary></details>

<details class="details_lb9f isBrowser_bmU9 alert alert--info details_b_Ee" data-collapsed="true" style="box-sizing: border-box; color: var(--ifm-alert-foreground-color); --ifm-alert-background-color: var(--ifm-color-info-contrast-background); --ifm-alert-background-color-highlight: #54c7ec26; --ifm-alert-foreground-color: var(--ifm-color-info-contrast-foreground); --ifm-alert-border-color: var(--ifm-color-info-dark); --ifm-code-background: var(--ifm-alert-background-color-highlight); --ifm-link-color: var(--ifm-alert-foreground-color); --ifm-link-hover-color: var(--ifm-alert-foreground-color); --ifm-link-decoration: underline; --ifm-tabs-color: var(--ifm-alert-foreground-color); --ifm-tabs-color-active: var(--ifm-alert-foreground-color); --ifm-tabs-color-active-border: var(--ifm-alert-border-color); background-color: var(--ifm-alert-background-color); border: 1px solid var(--ifm-alert-border-color); border-radius: var(--ifm-alert-border-radius); box-shadow: var(--ifm-alert-shadow); padding: var(--ifm-alert-padding-vertical) var(--ifm-alert-padding-horizontal); --docusaurus-details-summary-arrow-size: 0.38rem; --docusaurus-details-transition: transform var(--ifm-transition-fast) ease; --docusaurus-details-decoration-color: var(--ifm-alert-border-color); margin: 0 0 var(--ifm-spacing-vertical); font-family: system-ui, -apple-system, &quot;Segoe UI&quot;, Roboto, Ubuntu, Cantarell, &quot;Noto Sans&quot;, sans-serif, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="box-sizing: border-box; font-weight: 700; cursor: pointer; list-style: none; padding-left: 1rem; position: relative;">Typed import aliases</summary></details>

åœ¨ ELECTRON ä¸­ä½¿ç”¨ ES è¯­æ³•

Electron ç›®å‰å¯¹ [ECMAScript è¯­æ³•](https://nodejs.org/api/esm.html) (å¦‚ä½¿ç”¨ `import` æ¥å¯¼å…¥æ¨¡å—) çš„æ”¯æŒè¿˜ä¸å®Œå–„ã€‚ æ‚¨å¯ä»¥åœ¨ [electron/electron#21457](https://github.com/electron/electron/issues/21457) è¿™ä¸ª issue ä¸­æŸ¥çœ‹ ESM çš„é€‚é…è¿›å±•ã€‚

### å°†å¯å¤ç”¨çš„å‡½æ•°å†™å…¥å®ä¾‹åŒ–çª—å£

`createWindow()` å‡½æ•°å°†æ‚¨çš„é¡µé¢åŠ è½½åˆ°æ–°çš„ BrowserWindow å®ä¾‹ä¸­ï¼š

main.js (Lines 3-10)

```js
const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600
  })

  win.loadFile('index.html')
}
```



### åœ¨åº”ç”¨å‡†å¤‡å°±ç»ªæ—¶è°ƒç”¨å‡½æ•°

main.js (Lines 12-14)

```js
app.whenReady().then(() => {
  createWindow()
})
```



Electron çš„è®¸å¤šæ ¸å¿ƒæ¨¡å—éƒ½æ˜¯ Node.js çš„[äº‹ä»¶è§¦å‘å™¨](https://nodejs.org/api/events.html#events)ï¼Œéµå¾ª Node.js çš„å¼‚æ­¥äº‹ä»¶é©±åŠ¨æ¶æ„ã€‚ app æ¨¡å—å°±æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚

åœ¨ Electron ä¸­ï¼Œåªæœ‰åœ¨ app æ¨¡å—çš„ [`ready`](https://www.electronjs.org/zh/docs/latest/api/app#event-ready) äº‹ä»¶è§¦å‘åæ‰èƒ½åˆ›å»º BrowserWindows å®ä¾‹ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ [`app.whenReady()`](https://www.electronjs.org/zh/docs/latest/api/app#appwhenready) API æ¥ç›‘å¬æ­¤äº‹ä»¶ï¼Œå¹¶åœ¨å…¶æˆåŠŸåè°ƒç”¨ `createWindow()` æ–¹æ³•ã€‚

INFO

é€šå¸¸æˆ‘ä»¬ä½¿ç”¨è§¦å‘å™¨çš„ `.on` å‡½æ•°æ¥ç›‘å¬ Node.js äº‹ä»¶ã€‚

```diff
+ app.on('ready', () => {
- app.whenReady().then(() => {
  createWindow()
})
```



ä½†æ˜¯ Electron æš´éœ²äº† `app.whenReady()` æ–¹æ³•ï¼Œä½œä¸ºå…¶ `ready` äº‹ä»¶çš„ä¸“ç”¨ç›‘å¬å™¨ï¼Œè¿™æ ·å¯ä»¥é¿å…ç›´æ¥ç›‘å¬ .on äº‹ä»¶å¸¦æ¥çš„ä¸€äº›é—®é¢˜ã€‚ å‚è§ [electron/electron#21972](https://github.com/electron/electron/pull/21972) ã€‚

æ­¤æ—¶ï¼Œè¿è¡Œ `start` å‘½ä»¤åº”è¯¥èƒ½æˆåŠŸåœ°æ‰“å¼€ä¸€ä¸ªåŒ…å«æ‚¨ç½‘é¡µå†…å®¹çš„çª—å£ï¼

æ‚¨åº”ç”¨ä¸­çš„æ¯ä¸ªé¡µé¢éƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ä¸­è¿è¡Œï¼Œæˆ‘ä»¬ç§°è¿™äº›è¿›ç¨‹ä¸º **æ¸²æŸ“å™¨ (\*renderer\*)** ã€‚ æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨ä¸å¸¸è§„Webå¼€å‘ç›¸åŒçš„JavaScript APIå’Œå·¥å…·ï¼Œä¾‹å¦‚ä½¿ç”¨ [webpack](https://webpack.js.org/)æ¥æ‰“åŒ…å’Œå‹ç¼©æ‚¨çš„ä»£ç ï¼Œæˆ–ä½¿ç”¨ [React](https://reactjs.org/) æ„å»ºç”¨æˆ·ç•Œé¢ã€‚

## ç®¡ç†åº”ç”¨çš„çª—å£ç”Ÿå‘½å‘¨æœŸ

åº”ç”¨çª—å£åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸­çš„è¡Œä¸ºä¹Ÿä¸åŒã€‚ Electron å…è®¸æ‚¨è‡ªè¡Œå®ç°è¿™äº›è¡Œä¸ºæ¥éµå¾ªæ“ä½œç³»ç»Ÿçš„è§„èŒƒï¼Œè€Œä¸æ˜¯é‡‡ç”¨é»˜è®¤çš„å¼ºåˆ¶æ‰§è¡Œã€‚ æ‚¨å¯ä»¥é€šè¿‡ç›‘å¬ app å’Œ BrowserWindow æ¨¡ç»„çš„äº‹ä»¶ï¼Œè‡ªè¡Œå®ç°åŸºç¡€çš„åº”ç”¨çª—å£è§„èŒƒã€‚

é’ˆå¯¹ç‰¹å®šè¿›ç¨‹çš„æ§åˆ¶æµ

é€šè¿‡æ£€æŸ¥ Node.js çš„ [`process.platform`](https://nodejs.org/api/process.html#process_process_platform) å˜é‡ï¼Œæ‚¨å¯ä»¥é’ˆå¯¹ç‰¹å®šå¹³å°è¿è¡Œç‰¹å®šä»£ç ã€‚ è¯·æ³¨æ„ï¼ŒElectron ç›®å‰åªæ”¯æŒä¸‰ä¸ªå¹³å°ï¼š`win32` (Windows), `linux` (Linux) å’Œ `darwin` (macOS) ã€‚

### å…³é—­æ‰€æœ‰çª—å£æ—¶é€€å‡ºåº”ç”¨ (Windows & Linux)

åœ¨ Windows å’Œ Linux ä¸Šï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›åœ¨å…³é—­ä¸€ä¸ªåº”ç”¨çš„æ‰€æœ‰çª—å£åè®©å®ƒé€€å‡ºã€‚ è¦åœ¨æ‚¨çš„Electronåº”ç”¨ä¸­å®ç°è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥ç›‘å¬ app æ¨¡å—çš„ [`window-all-closed`](https://www.electronjs.org/zh/docs/latest/api/app#event-window-all-closed) äº‹ä»¶ï¼Œå¹¶è°ƒç”¨ [`app.quit()`](https://www.electronjs.org/zh/docs/latest/api/app#appquit) æ¥é€€å‡ºæ‚¨çš„åº”ç”¨ç¨‹åºã€‚æ­¤æ–¹æ³•ä¸é€‚ç”¨äº macOSã€‚

```js
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') app.quit()
})
```



### å¦‚æœæ²¡æœ‰çª—å£æ‰“å¼€åˆ™æ‰“å¼€ä¸€ä¸ªçª—å£ (macOS)

ä¸å‰äºŒè€…ç›¸æ¯”ï¼Œå³ä½¿æ²¡æœ‰æ‰“å¼€ä»»ä½•çª—å£ï¼ŒmacOS åº”ç”¨é€šå¸¸ä¹Ÿä¼šç»§ç»­è¿è¡Œã€‚ åœ¨æ²¡æœ‰çª—å£å¯ç”¨æ—¶è°ƒç”¨ app ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çª—å£ã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‰¹æ€§ï¼Œå¯ä»¥ç›‘å¬æ¨¡ç»„çš„ [`activate`](https://www.electronjs.org/zh/docs/latest/api/app#event-activate-macos) äº‹ä»¶ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•æ´»åŠ¨çš„ BrowserWindowï¼Œè°ƒç”¨ `createWindow()` æ–¹æ³•æ–°å»ºä¸€ä¸ªã€‚

å› ä¸ºçª—å£æ— æ³•åœ¨ `ready` äº‹ä»¶å‰åˆ›å»ºï¼Œä½ åº”å½“åœ¨ä½ çš„åº”ç”¨åˆå§‹åŒ–åä»…ç›‘å¬ `activate` äº‹ä»¶ã€‚ è¦å®ç°è¿™ä¸ªï¼Œä»…ç›‘å¬ `whenReady()` å›è°ƒå³å¯ã€‚

```js
app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) createWindow()
  })
})
```



## å®Œæ•´å®ç°ä»£ç 

[DOCS/FIDDLES/TUTORIAL-FIRST-APP (27.0.2)](https://github.com/electron/electron/tree/v27.0.2/docs/fiddles/tutorial-first-app)[Open in Fiddle](https://fiddle.electronjs.org/launch?target=electron/v27.0.2/docs/fiddles/tutorial-first-app)

- main.js
- index.html

```js
const { app, BrowserWindow } = require('electron')

const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600
  })

  win.loadFile('index.html')
}

app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow()
    }
  })
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }
})
```



## å¯é€‰ï¼šä½¿ç”¨ VS Code è°ƒè¯•

å¦‚æœæ‚¨å¸Œæœ›ä½¿ç”¨ VS Code è°ƒè¯•æ‚¨çš„ç¨‹åºï¼Œæ‚¨éœ€è¦è®© VS Code ç›‘å¬ä¸»è¿›ç¨‹ (main process) å’Œæ¸²æŸ“å™¨è¿›ç¨‹ (renderer process) ã€‚ ä¸‹é¢ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªç®€å•çš„é…ç½®æ–‡ä»¶ã€‚ è¯·åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª `.vscode` æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨å…¶ä¸­æ–°å»ºä¸€ä¸ª launch.json é…ç½®æ–‡ä»¶å¹¶å¡«å†™å¦‚ä¸‹å†…å®¹ã€‚

.vscode/launch.json

```json
{
  "version": "0.2.0",
  "compounds": [
    {
      "name": "Main + renderer",
      "configurations": ["Main", "Renderer"],
      "stopAll": true
    }
  ],
  "configurations": [
    {
      "name": "Renderer",
      "port": 9222,
      "request": "attach",
      "type": "chrome",
      "webRoot": "${workspaceFolder}"
    },
    {
      "name": "Main",
      "type": "node",
      "request": "launch",
      "cwd": "${workspaceFolder}",
      "runtimeExecutable": "${workspaceFolder}/node_modules/.bin/electron",
      "windows": {
        "runtimeExecutable": "${workspaceFolder}/node_modules/.bin/electron.cmd"
      },
      "args": [".", "--remote-debugging-port=9222"],
      "outputCapture": "std",
      "console": "integratedTerminal"
    }
  ]
}
```



ä¿å­˜åï¼Œå½“æ‚¨é€‰æ‹©ä¾§è¾¹æ çš„ â€œè¿è¡Œå’Œè°ƒè¯•â€ï¼Œå°†ä¼šå‡ºç°ä¸€ä¸ª "Main + renderer" é€‰é¡¹ã€‚ç„¶åæ‚¨ä¾¿å¯è®¾ç½®æ–­ç‚¹ï¼Œå¹¶è·Ÿè¸ªä¸»è¿›ç¨‹å’Œæ¸²æŸ“å™¨è¿›ç¨‹ä¸­çš„æ‰€æœ‰å˜é‡ã€‚

ä¸Šæ–‡ä¸­æˆ‘ä»¬åœ¨ `launch.json` æ‰€åšçš„å…¶å®æ˜¯åˆ›å»ºä¸‰ä¸ªé…ç½®é¡¹ï¼š

- `Main` ç”¨æ¥è¿è¡Œä¸»ç¨‹åºï¼Œå¹¶ä¸”æš´éœ²å‡º 9222 ç«¯å£ç”¨äºè¿œç¨‹è°ƒè¯• (`--remote-debugging-port=9222`) ã€‚ æˆ‘ä»¬å°†æŠŠè°ƒè¯•å™¨ç»‘å®šåˆ°é‚£ä¸ªç«¯å£æ¥è°ƒè¯• `renderer` ã€‚ å› ä¸ºä¸»è¿›ç¨‹æ˜¯ Node.js è¿›ç¨‹ï¼Œç±»å‹è¢«è®¾ç½®ä¸º `node`ã€‚
- `Renderer` ç”¨æ¥è°ƒè¯•æ¸²æŸ“å™¨è¿›ç¨‹ã€‚ å› ä¸ºåè€…æ˜¯ç”±ä¸»è¿›ç¨‹åˆ›å»ºçš„ï¼Œæˆ‘ä»¬è¦æŠŠå®ƒ â€œç»‘å®šâ€ åˆ°ä¸»è¿›ç¨‹ä¸Š ()`"request": "attach"`ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚ æ¸²æŸ“å™¨æ˜¯ web è¿›ç¨‹ï¼Œå› æ­¤è¦é€‰æ‹© `chrome` è°ƒè¯•å™¨ã€‚
- `Main + renderer` æ˜¯ä¸€ä¸ª [å¤åˆä»»åŠ¡](https://code.visualstudio.com/Docs/editor/tasks#_compound-tasks)ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œä¸Šè¿°ä»»åŠ¡ã€‚

æ³¨æ„äº‹é¡¹

ç”±äºæˆ‘ä»¬è¦å°†è¿›ç¨‹ç»‘å®šåˆ° `Renderer` ä»»åŠ¡ï¼Œæ‚¨åº”ç”¨ä¸­çš„å‰å‡ è¡Œä»£ç å¯èƒ½ä¼šè¢«è·³è¿‡ï¼Œå› ä¸ºè°ƒè¯•å™¨ (Debugger) åœ¨æ‰§è¡Œä»£ç ä¹‹å‰æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´è¿›è¡Œè¿æ¥ã€‚ åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡åˆ·æ–°é¡µé¢æˆ–è€…ä½¿ç”¨ setTimeout å»¶è¿Ÿè¿è¡Œä»£ç ï¼Œæ¥é¿å¼€è¿™ä¸ªé—®é¢˜ã€‚

å»¶ä¼¸é˜…è¯»

å¦‚æœæ‚¨å¸Œæœ›æ·±æŒ–è°ƒè¯•æ­¥éª¤ï¼Œå¯ä»¥æŸ¥çœ‹ä»¥ä¸‹æŒ‡å—ï¼š

- [è°ƒè¯•åº”ç”¨](https://www.electronjs.org/zh/docs/latest/tutorial/application-debugging)
- [DevTools æ‰©å±•](https://www.electronjs.org/zh/docs/latest/tutorial/devtools-extension)

## æ‘˜è¦

Electron ç¨‹åºæ˜¯é€šè¿‡ npm åŒ…åˆ›å»ºçš„ã€‚ æ‚¨åº”å°† Electron ä¾èµ–å®‰è£…åˆ° `devDependencies` ï¼Œç„¶ååœ¨ package.json ä¸­è®¾ç½®ä¸€ä¸ªè„šæœ¬æ¥è¿è¡Œã€‚

æ‰§è¡Œå‘½ä»¤åï¼ŒElectron ç¨‹åºä¼šè¿è¡Œæ‚¨åœ¨ package.json æ–‡ä»¶çš„ `main` å­—æ®µè®¾ç½®çš„å…¥å£æ–‡ä»¶ã€‚ è¿™ä¸ªå…¥å£æ–‡ä»¶æ§åˆ¶ç€ Electron çš„**ä¸»è¿›ç¨‹**ï¼Œåè€…è¿è¡Œäº Node.js å®ä¾‹ï¼Œè´Ÿè´£åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€å±•ç¤ºåŸç”Ÿçª—å£ã€æ‰§è¡Œç‰¹æ®Šæ“ä½œå’Œç®¡ç†æ¸²æŸ“è¿›ç¨‹ã€‚

**æ¸²æŸ“å™¨è¿›ç¨‹**(ç®€ç§°æ¸²æŸ“å™¨) è´Ÿè´£å±•ç¤ºå›¾å½¢å†…å®¹ã€‚ æ‚¨å¯ä»¥å°†æ¸²æŸ“çš„ç½‘é¡µæŒ‡å‘ web åœ°å€æˆ–æœ¬åœ° HTML æ–‡ä»¶ã€‚ æ¸²æŸ“å™¨å’Œå¸¸è§„çš„ç½‘é¡µè¡Œä¸ºå¾ˆç›¸ä¼¼ï¼Œè®¿é—®çš„ web API ä¹Ÿç›¸åŒã€‚

åœ¨æ•™ç¨‹ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨ API ç»™æ¸²æŸ“å™¨ææƒï¼Œä»¥åŠå¦‚ä½•åœ¨è¿›ç¨‹é—´é€šä¿¡ã€‚

# ä½¿ç”¨é¢„åŠ è½½è„šæœ¬

æ•™ç¨‹ç›®å½•

è¿™æ˜¯ Electron æ•™ç¨‹çš„**ç¬¬ä¸‰éƒ¨åˆ†**ã€‚

1. [åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)
2. [åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)
3. **[ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)**
4. [æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)
5. [æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)
6. [å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)

## å­¦ä¹ ç›®æ ‡

åœ¨è¿™éƒ¨åˆ†çš„æ•™ç¨‹ä¸­ï¼Œä½ å°†ä¼šäº†è§£ä»€ä¹ˆæ˜¯é¢„åŠ è½½è„šæœ¬ï¼Œå¹¶ä¸”å­¦ä¼šå¦‚ä½•ä½¿ç”¨é¢„åŠ è½½è„šæœ¬æ¥å®‰å…¨åœ°å°†ç‰¹æƒ API æš´éœ²è‡³æ¸²æŸ“è¿›ç¨‹ä¸­ã€‚ ä¸ä»…å¦‚æ­¤ï¼Œä½ è¿˜ä¼šå­¦åˆ°å¦‚ä½•ä½¿ç”¨ Electron çš„è¿›ç¨‹é—´é€šä¿¡ (IPC) æ¨¡ç»„æ¥è®©ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹é—´è¿›è¡Œé€šä¿¡ã€‚

## ä»€ä¹ˆæ˜¯é¢„åŠ è½½è„šæœ¬ï¼Ÿ

Electron çš„ä¸»è¿›ç¨‹æ˜¯ä¸€ä¸ªæ‹¥æœ‰ç€å®Œå…¨æ“ä½œç³»ç»Ÿè®¿é—®æƒé™çš„ Node.js ç¯å¢ƒã€‚ é™¤äº† [Electron æ¨¡ç»„](https://www.electronjs.org/zh/docs/latest/api/app) ä¹‹å¤–ï¼Œæ‚¨ä¹Ÿå¯ä»¥è®¿é—® [Node.js å†…ç½®æ¨¡å—](https://nodejs.org/dist/latest/docs/api/) å’Œæ‰€æœ‰é€šè¿‡ npm å®‰è£…çš„åŒ…ã€‚ å¦ä¸€æ–¹é¢ï¼Œå‡ºäºå®‰å…¨åŸå› ï¼Œæ¸²æŸ“è¿›ç¨‹é»˜è®¤è·‘åœ¨ç½‘é¡µé¡µé¢ä¸Šï¼Œè€Œå¹¶é Node.jsé‡Œã€‚

ä¸ºäº†å°† Electron çš„ä¸åŒç±»å‹çš„è¿›ç¨‹æ¡¥æ¥åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨è¢«ç§°ä¸º **é¢„åŠ è½½** çš„ç‰¹æ®Šè„šæœ¬ã€‚

## ä½¿ç”¨é¢„åŠ è½½è„šæœ¬æ¥å¢å¼ºæ¸²æŸ“å™¨

BrowserWindow çš„é¢„åŠ è½½è„šæœ¬è¿è¡Œåœ¨å…·æœ‰ HTML DOM å’Œ Node.jsã€Electron API çš„æœ‰é™å­é›†è®¿é—®æƒé™çš„ç¯å¢ƒä¸­ã€‚

::: info é¢„åŠ è½½è„šæœ¬æ²™ç›’åŒ–

ä» Electron 20 å¼€å§‹ï¼Œé¢„åŠ è½½è„šæœ¬é»˜è®¤ **æ²™ç›’åŒ–** ï¼Œä¸å†æ‹¥æœ‰å®Œæ•´ Node.js ç¯å¢ƒçš„è®¿é—®æƒã€‚ å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€ä½ åªæ‹¥æœ‰ä¸€ä¸ª polyfilled çš„ `require` å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åªèƒ½è®¿é—®ä¸€ç»„æœ‰é™çš„ APIã€‚

| å¯ç”¨çš„ API            | è¯¦ç»†ä¿¡æ¯                                                     |
| --------------------- | ------------------------------------------------------------ |
| Electron æ¨¡å—         | æ¸²æŸ“è¿›ç¨‹æ¨¡å—                                                 |
| Node.js æ¨¡å—          | [`events`](https://nodejs.org/api/events.html)ã€[`timers`](https://nodejs.org/api/timers.html)ã€[`url`](https://nodejs.org/api/url.html) |
| Polyfilled çš„å…¨å±€æ¨¡å— | [`Buffer`](https://nodejs.org/api/buffer.html)ã€[`process`](https://www.electronjs.org/zh/docs/latest/api/process)ã€[`clearImmediate`](https://nodejs.org/api/timers.html#timers_clearimmediate_immediate)ã€[`setImmediate`](https://nodejs.org/api/timers.html#timers_setimmediate_callback_args) |

æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·é˜…è¯» [æ²™ç›’è¿›ç¨‹](https://www.electronjs.org/zh/docs/latest/tutorial/sandbox) æ•™ç¨‹ã€‚

:::

ä¸ Chrome æ‰©å±•çš„[å†…å®¹è„šæœ¬](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)ï¼ˆContent Scriptï¼‰ç±»ä¼¼ï¼Œé¢„åŠ è½½è„šæœ¬åœ¨æ¸²æŸ“å™¨åŠ è½½ç½‘é¡µä¹‹å‰æ³¨å…¥ã€‚ å¦‚æœä½ æƒ³ä¸ºæ¸²æŸ“å™¨æ·»åŠ éœ€è¦ç‰¹æ®Šæƒé™çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ [contextBridge](https://www.electronjs.org/zh/docs/latest/api/context-bridge) æ¥å£å®šä¹‰ [å…¨å±€å¯¹è±¡](https://developer.mozilla.org/en-US/docs/Glossary/Global_object)ã€‚

ä¸ºäº†æ¼”ç¤ºè¿™ä¸€æ¦‚å¿µï¼Œä½ å°†ä¼šåˆ›å»ºä¸€ä¸ªå°†åº”ç”¨ä¸­çš„ Chromeã€Nodeã€Electron ç‰ˆæœ¬å·æš´éœ²è‡³æ¸²æŸ“å™¨çš„é¢„åŠ è½½è„šæœ¬

æ–°å»ºä¸€ä¸ª `preload.js` æ–‡ä»¶ã€‚è¯¥è„šæœ¬é€šè¿‡ `versions` è¿™ä¸€å…¨å±€å˜é‡ï¼Œå°† Electron çš„ `process.versions` å¯¹è±¡æš´éœ²ç»™æ¸²æŸ“å™¨ã€‚

preload.js

```js
const { contextBridge } = require('electron')

contextBridge.exposeInMainWorld('versions', {
  node: () => process.versions.node,
  chrome: () => process.versions.chrome,
  electron: () => process.versions.electron
  // é™¤å‡½æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æš´éœ²å˜é‡
})
```



ä¸ºäº†å°†è„šæœ¬é™„åœ¨æ¸²æŸ“è¿›ç¨‹ä¸Šï¼Œåœ¨ BrowserWindow æ„é€ å™¨ä¸­ä½¿ç”¨ `webPreferences.preload` ä¼ å…¥è„šæœ¬çš„è·¯å¾„ã€‚

main.js

```js
const { app, BrowserWindow } = require('electron')
const path = require('node:path')

const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  win.loadFile('index.html')
}

app.whenReady().then(() => {
  createWindow()
})
```



INFO

è¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªNode.jsæ¦‚å¿µï¼š

- [`__dirname`](https://nodejs.org/api/modules.html#modules_dirname) å­—ç¬¦ä¸²æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„è·¯å¾„(åœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒæŒ‡å‘ä½ çš„é¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹)ã€‚
- [`path.join`](https://nodejs.org/api/path.html#path_path_join_paths) API å°†å¤šä¸ªè·¯å¾„è”ç»“åœ¨ä¸€èµ·ï¼Œåˆ›å»ºä¸€ä¸ªè·¨å¹³å°çš„è·¯å¾„å­—ç¬¦ä¸²ã€‚

ç°åœ¨æ¸²æŸ“å™¨èƒ½å¤Ÿå…¨å±€è®¿é—® `versions` äº†ï¼Œè®©æˆ‘ä»¬å¿«å¿«å°†é‡Œè¾¹çš„ä¿¡æ¯æ˜¾ç¤ºåœ¨çª—å£ä¸­ã€‚ è¿™ä¸ªå˜é‡ä¸ä»…å¯ä»¥é€šè¿‡ `window.versions` è®¿é—®ï¼Œä¹Ÿå¯ä»¥å¾ˆç®€å•åœ°ä½¿ç”¨ `versions` æ¥è®¿é—®ã€‚ æ–°å»ºä¸€ä¸ª `renderer.js` è„šæœ¬ï¼Œ ä½¿ç”¨ [`document.getElementById`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById) DOM API æ¥æ›¿æ¢ `id` å±æ€§ä¸º `info` çš„ HTML å…ƒç´ çš„æ–‡æœ¬ã€‚

renderer.js

```js
const information = document.getElementById('info')
information.innerText = `æœ¬åº”ç”¨æ­£åœ¨ä½¿ç”¨ Chrome (v${versions.chrome()}), Node.js (v${versions.node()}), å’Œ Electron (v${versions.electron()})`
```



ç„¶åè¯·ä¿®æ”¹ä½ çš„ `index.html` æ–‡ä»¶ã€‚åŠ ä¸Šä¸€ä¸ª `id` å±æ€§ä¸º `info` çš„å…¨æ–°å…ƒç´ ï¼Œå¹¶ä¸”è®°å¾—åŠ ä¸Šä½ çš„ `renderer.js` è„šæœ¬ï¼š

index.html

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <meta
      http-equiv="X-Content-Security-Policy"
      content="default-src 'self'; script-src 'self'"
    />
    <title>æ¥è‡ª Electron æ¸²æŸ“å™¨çš„é—®å¥½ï¼</title>
  </head>
  <body>
    <h1>æ¥è‡ª Electron æ¸²æŸ“å™¨çš„é—®å¥½ï¼</h1>
    <p>ğŸ‘‹</p>
    <p id="info"></p>
  </body>
  <script src="./renderer.js"></script>
</html>
```



åšå®Œè¿™å‡ æ­¥ä¹‹åï¼Œä½ çš„åº”ç”¨åº”è¯¥é•¿è¿™æ ·ï¼š

![](img/preload-example-f77948d27686974e427084fa94fe620c.png)

ä½ çš„ä»£ç åº”è¯¥é•¿è¿™æ ·ï¼š

[DOCS/FIDDLES/TUTORIAL-PRELOAD (27.0.2)](https://github.com/electron/electron/tree/v27.0.2/docs/fiddles/tutorial-preload)[Open in Fiddle](https://fiddle.electronjs.org/launch?target=electron/v27.0.2/docs/fiddles/tutorial-preload)

- main.js
- preload.js
- index.html
- renderer.js

```js
const { app, BrowserWindow } = require('electron')
const path = require('node:path')

const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })

  win.loadFile('index.html')
}

app.whenReady().then(() => {
  createWindow()

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow()
    }
  })
})

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }
})
```



## åœ¨è¿›ç¨‹ä¹‹é—´é€šä¿¡

æˆ‘ä»¬ä¹‹å‰æåˆ°ï¼ŒElectron çš„ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹æœ‰ç€æ¸…æ¥šçš„åˆ†å·¥å¹¶ä¸”ä¸å¯äº’æ¢ã€‚ è¿™ä»£è¡¨ç€æ— è®ºæ˜¯ä»æ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—® Node.js æ¥å£ï¼Œäº¦æˆ–è€…æ˜¯ä»ä¸»è¿›ç¨‹è®¿é—® HTML æ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM)ï¼Œéƒ½æ˜¯ä¸å¯èƒ½çš„ã€‚

è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨è¿›ç¨‹é—´é€šä¿¡ (IPC)ã€‚å¯ä»¥ä½¿ç”¨ Electron çš„ `ipcMain` æ¨¡å—å’Œ `ipcRenderer` æ¨¡å—æ¥è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ã€‚ ä¸ºäº†ä»ä½ çš„ç½‘é¡µå‘ä¸»è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ `ipcMain.handle` è®¾ç½®ä¸€ä¸ªä¸»è¿›ç¨‹å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ï¼Œç„¶ååœ¨é¢„å¤„ç†è„šæœ¬ä¸­æš´éœ²ä¸€ä¸ªè¢«ç§°ä¸º `ipcRenderer.invoke` çš„å‡½æ•°æ¥è§¦å‘è¯¥å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰ã€‚

æˆ‘ä»¬å°†å‘æ¸²æŸ“å™¨æ·»åŠ ä¸€ä¸ªå«åš `ping()` çš„å…¨å±€å‡½æ•°æ¥æ¼”ç¤ºè¿™ä¸€ç‚¹ã€‚è¿™ä¸ªå‡½æ•°å°†è¿”å›ä¸€ä¸ªä»ä¸»è¿›ç¨‹ç¿»å±±è¶Šå²­è€Œæ¥çš„å­—ç¬¦ä¸²ã€‚

é¦–å…ˆï¼Œåœ¨é¢„å¤„ç†è„šæœ¬ä¸­è®¾ç½® `invoke` è°ƒç”¨ï¼š

preload.js

```js
const { contextBridge, ipcRenderer } = require('electron')

contextBridge.exposeInMainWorld('versions', {
  node: () => process.versions.node,
  chrome: () => process.versions.chrome,
  electron: () => process.versions.electron,
  ping: () => ipcRenderer.invoke('ping')
  // é™¤å‡½æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æš´éœ²å˜é‡
})
```



IPC å®‰å…¨

å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªè¾…åŠ©å‡½æ•°æ¥åŒ…è£¹ `ipcRenderer.invoke('ping')` è°ƒç”¨ï¼Œè€Œå¹¶éç›´æ¥é€šè¿‡ context bridge æš´éœ² `ipcRenderer` æ¨¡å—ã€‚ ä½ **æ°¸è¿œ**éƒ½ä¸ä¼šæƒ³è¦é€šè¿‡é¢„åŠ è½½ç›´æ¥æš´éœ²æ•´ä¸ª `ipcRenderer` æ¨¡å—ã€‚ è¿™å°†ä½¿å¾—ä½ çš„æ¸²æŸ“å™¨èƒ½å¤Ÿç›´æ¥å‘ä¸»è¿›ç¨‹å‘é€ä»»æ„çš„ IPC ä¿¡æ¯ï¼Œä¼šä½¿å¾—å…¶æˆä¸ºæ¶æ„ä»£ç æœ€å¼ºæœ‰åŠ›çš„æ”»å‡»åª’ä»‹ã€‚

ç„¶åï¼Œåœ¨ä¸»è¿›ç¨‹ä¸­è®¾ç½®ä½ çš„ `handle` ç›‘å¬å™¨ã€‚ æˆ‘ä»¬åœ¨ HTML æ–‡ä»¶åŠ è½½*ä¹‹å‰*å®Œæˆäº†è¿™äº›ï¼Œæ‰€ä»¥æ‰èƒ½ä¿è¯åœ¨ä½ ä»æ¸²æŸ“å™¨å‘é€ `invoke` è°ƒç”¨ä¹‹å‰å¤„ç†ç¨‹åºèƒ½å¤Ÿå‡†å¤‡å°±ç»ªã€‚

main.js

```js
const { app, BrowserWindow, ipcMain } = require('electron')
const path = require('node:path')

const createWindow = () => {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  })
  win.loadFile('index.html')
}
app.whenReady().then(() => {
  ipcMain.handle('ping', () => 'pong')
  createWindow()
})
```



å°†å‘é€å™¨ä¸æ¥æ”¶å™¨è®¾ç½®å®Œæˆä¹‹åï¼Œç°åœ¨ä½ å¯ä»¥å°†ä¿¡æ¯é€šè¿‡åˆšåˆšå®šä¹‰çš„ `'ping'` é€šé“ä»æ¸²æŸ“å™¨å‘é€è‡³ä¸»è¿›ç¨‹å½“ä¸­ã€‚

renderer.js

```js
const func = async () => {
  const response = await window.versions.ping()
  console.log(response) // æ‰“å° 'pong'
}

func()
```



INFO

è¦äº†è§£æ›´è¯¦ç»†çš„å…³äºä½¿ç”¨ `ipcRenderer` å’Œ `ipcMain` æ¨¡å—çš„è¯¦ç»†è¯´æ˜ï¼Œè¯·æŸ¥é˜…å®Œæ•´çš„ [è¿›ç¨‹é—´é€šä¿¡](https://www.electronjs.org/zh/docs/latest/tutorial/ipc) æŒ‡å—ã€‚

## æ‘˜è¦

é¢„åŠ è½½è„šæœ¬åŒ…å«åœ¨æµè§ˆå™¨çª—å£åŠ è½½ç½‘é¡µä¹‹å‰è¿è¡Œçš„ä»£ç ã€‚ å…¶å¯è®¿é—® DOM æ¥å£å’Œ Node.js ç¯å¢ƒï¼Œå¹¶ä¸”ç»å¸¸åœ¨å…¶ä¸­ä½¿ç”¨ `contextBridge` æ¥å£å°†ç‰¹æƒæ¥å£æš´éœ²ç»™æ¸²æŸ“å™¨ã€‚

ç”±äºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹æœ‰ç€å®Œå…¨ä¸åŒçš„åˆ†å·¥ï¼ŒElectron åº”ç”¨é€šå¸¸ä½¿ç”¨é¢„åŠ è½½è„šæœ¬æ¥è®¾ç½®è¿›ç¨‹é—´é€šä¿¡ (IPC) æ¥å£ä»¥åœ¨ä¸¤ç§è¿›ç¨‹ä¹‹é—´ä¼ è¾“ä»»æ„ä¿¡æ¯ã€‚

åœ¨ä¸‹ä¸€éƒ¨åˆ†çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å‘ä½ å±•ç¤ºå¦‚ä½•å‘ä½ çš„åº”ç”¨ä¸­æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ï¼Œä¹‹åå°†å‘ä½ ä¼ æˆå¦‚ä½•å‘ç”¨æˆ·åˆ†å‘ä½ çš„åº”ç”¨ã€‚

# æ·»åŠ åŠŸèƒ½

æ•™ç¨‹ç›®å½•

è¿™æ˜¯ Electron æ•™ç¨‹çš„ **ç¬¬å››éƒ¨åˆ†**

1. [åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)
2. [åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)
3. [ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)
4. **[æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)**
5. [æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)
6. [å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)

## å¢åŠ åº”ç”¨å¤æ‚åº¦

å¦‚æœä½ ä¸€è·¯è·Ÿéšæœ¬æ•™ç¨‹ä¸‹æ¥ï¼Œä½ åº”è¯¥å·²ç»å»ºç«‹äº†ä¸€ä¸ªæ‹¥æœ‰é™æ€ç”¨æˆ·ç•Œé¢çš„åŠŸèƒ½æ€§ Electron ç¨‹åºã€‚ ä»è¿™é‡Œå¼€å§‹ï¼Œä½ å¯ä»¥å¤§æ¦‚ä»ä¸¤ä¸ªå¤§æ–¹å‘ä¸Šè¿›è¡Œå¼€å‘ï¼š

1. å¢åŠ æ¸²æŸ“è¿›ç¨‹çš„ç½‘é¡µåº”ç”¨ä»£ç å¤æ‚åº¦
2. æ·±åŒ–ä¸æ“ä½œç³»ç»Ÿå’Œ Node.js çš„é›†æˆ

äº†è§£è¿™ä¸¤ä¸ªå¤§æ¦‚å¿µä¹‹é—´çš„åŒºåˆ«ååˆ†é‡è¦ã€‚ å°±ç¬¬ä¸€ç‚¹è€Œè¨€ï¼ŒElectron ç‰¹ä¾›çš„èµ„æºæ˜¯éå¿…è¦çš„ã€‚ åœ¨ Electron ä¸­å»ºç«‹ä¸€ä¸ªæ¼‚äº®çš„å¾…åŠåˆ—è¡¨åªæ˜¯å°†ä½ çš„ Electron BrowserWindow æŒ‡å‘ä¸€ä¸ªæ¼‚äº®çš„å¾…åŠåˆ—è¡¨ç½‘ç»œåº”ç”¨ã€‚ è¯´åˆ°åº•ï¼Œä½ è¿˜æ˜¯ä½¿ç”¨åœ¨ Web å¼€å‘ä¸­ç›¸åŒçš„å·¥å…· (HTML, CSS, JavaScript) æ¥æ„å»ºä½ çš„æ¸²æŸ“å™¨ UIã€‚ å› æ­¤ï¼ŒElectron çš„æ–‡æ¡£ä¸ä¼šå¾ˆè¯¦ç»†çš„æ¢è®¨å¦‚ä½•ä½¿ç”¨æ ‡å‡†çš„ Web å·¥å…·è¿›è¡Œå¼€å‘ã€‚

å¦ä¸€æ–¹é¢ï¼ŒElectron åŒæ—¶æä¾›äº†ä¸°å¯Œçš„å·¥å…·é›†ï¼Œå¯ä»¥è®©ä½ å’Œæ¡Œé¢ç¯å¢ƒæ•´åˆèµ·æ¥ã€‚ä»å»ºç«‹æ‰˜ç›˜å›¾æ ‡åˆ°æ·»åŠ å…¨å±€çš„å¿«æ·æ–¹å¼ï¼Œå†åˆ°æ˜¾ç¤ºåŸç”Ÿçš„èœå•ï¼Œéƒ½ä¸åœ¨è¯ä¸‹ã€‚ Electron è¿˜èµ‹äºˆä½ åœ¨ä¸»è¿›ç¨‹ä¸­è®¿é—® Node.js ç¯å¢ƒçš„æ‰€æœ‰èƒ½åŠ›ã€‚ è¿™ç»„èƒ½åŠ›ä½¿å¾— Electron åº”ç”¨èƒ½å¤Ÿä»æµè§ˆå™¨è¿è¡Œç½‘ç«™ä¸­è„±èƒæ¢éª¨ï¼Œå¹¶ä¸”æ˜¯ Electron æ–‡æ¡£çš„é‡ç‚¹ã€‚

## How-to ç¤ºä¾‹

Electron çš„æ–‡æ¡£æœ‰ç€è®¸å¤šæ•™ç¨‹æ¥å¸®åŠ©ä½ å¤„ç†æ›´é«˜çº§çš„ä¸»é¢˜å’Œæ›´æ·±çš„æ“ä½œç³»ç»Ÿé›†æˆã€‚ è¦å¼€å§‹ä½¿ç”¨ï¼Œè¯·æŸ¥çœ‹ [æ“ä½œæ–¹æ³•ç¤ºä¾‹](https://www.electronjs.org/zh/docs/latest/tutorial/examples) æ–‡æ¡£ã€‚

è¯·å‘Šè¯‰æˆ‘ä»¬å“ªé‡Œæœ‰é—æ¼ï¼

å¦‚æœä½ æ‰¾ä¸åˆ°ä½ æƒ³æ‰¾çš„ä¸œè¥¿ï¼Œè¯·åœ¨ [GitHub](https://github.com/electron/website/issues/new) æˆ–è€…æ˜¯ [Discord æœåŠ¡å™¨](https://discord.gg/electronjs) ä¸Šå‘Šè¯‰æˆ‘ä»¬ï¼

## ä¸‹ä¸€æ­¥

åœ¨æ•™ç¨‹çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä»åº”ç”¨ä»£ç è½¬å‘å¦‚ä½•è®©ä½ çš„åº”ç”¨ä»å¼€å‘è€…çš„æœºå™¨ä¸Šè½¬ç§»åˆ°ç»ˆç«¯ç”¨æˆ·çš„æ‰‹ä¸­ã€‚

# æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº

æ•™ç¨‹ç›®å½•

ä»¥ä¸‹æ˜¯ Electron æ•™ç¨‹çš„ **ç¬¬äº”éƒ¨åˆ†**

1. [åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)
2. [åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)
3. [ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)
4. [æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)
5. **[æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)**
6. [å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)

## å­¦ä¹ ç›®æ ‡

åœ¨æœ¬æ•™ç¨‹çš„è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä½¿ç”¨ [Electron Forge](https://www.electronforge.io/) æ‰“åŒ…å’Œåˆ†å‘åº”ç”¨çš„åŸºç¡€çŸ¥è¯†ã€‚

## ä½¿ç”¨ Electron Forge

Electron çš„æ ¸å¿ƒæ¨¡å—ä¸­æ²¡æœ‰æ†ç»‘ä»»ä½•ç”¨äºæ‰“åŒ…æˆ–åˆ†å‘æ–‡ä»¶çš„å·¥å…·ã€‚ å¦‚æœæ‚¨åœ¨å¼€å‘æ¨¡å¼ä¸‹å®Œæˆäº†ä¸€ä¸ª Electron åº”ç”¨ï¼Œéœ€è¦ä½¿ç”¨é¢å¤–çš„å·¥å…·æ¥æ‰“åŒ…åº”ç”¨ç¨‹åº (ä¹Ÿç§°ä¸º**å¯åˆ†å‘æ–‡ä»¶**) å¹¶åˆ†å‘ç»™ç”¨æˆ· ã€‚ å¯åˆ†å‘æ–‡ä»¶å¯ä»¥æ˜¯å®‰è£…ç¨‹åº (ä¾‹å¦‚ Windows ä¸Šçš„ MSI) æˆ–è€…ç»¿è‰²è½¯ä»¶ (ä¾‹å¦‚ macOS ä¸Šçš„ `.app` æ–‡ä»¶)ã€‚

Electron Forge æ˜¯ä¸€ä¸ªå¤„ç† Electron åº”ç”¨ç¨‹åºæ‰“åŒ…ä¸åˆ†å‘çš„ä¸€ä½“åŒ–å·¥å…·ã€‚ åœ¨å·¥å…·åº•å±‚ï¼Œå®ƒå°†è®¸å¤šç°æœ‰çš„ Electron å·¥å…· (ä¾‹å¦‚ [`electron-packager`](https://github.com/electron/electron-packager)ã€ [`@electron/osx-sign`](https://github.com/electron/osx-sign)ã€[`electron-winstaller`](https://github.com/electron/windows-installer) ç­‰) ç»„åˆåˆ°ä¸€èµ·ï¼Œå› æ­¤æ‚¨ä¸å¿…è´¹å¿ƒå¤„ç†ä¸åŒç³»ç»Ÿçš„æ‰“åŒ…å·¥ä½œã€‚

### å¯¼å…¥ä½ çš„é¡¹ç›®åˆ° Forge

å°† Electron Forge çš„ CLI å·¥å…·åŒ…å®‰è£…åˆ°é¡¹ç›®çš„ `devDependencies` ä¾èµ–ä¸­ï¼Œç„¶åä½¿ç”¨ç°æˆçš„è½¬åŒ–è„šæœ¬å°†é¡¹ç›®å¯¼å…¥è‡³ Electron Forgeã€‚

- npm
- Yarn

```sh
npm install --save-dev @electron-forge/cli
npx electron-forge import
```



è½¬æ¢è„šæœ¬å®Œæˆåï¼ŒForge ä¼šå°†ä¸€äº›è„šæœ¬æ·»åŠ åˆ°æ‚¨çš„ `package.json` æ–‡ä»¶ä¸­ã€‚

package.json

```json
  //...
  "scripts": {
    "start": "electron-forge start",
    "package": "electron-forge package",
    "make": "electron-forge make"
  },
  //...
```



CLI æ–‡æ¡£

æœ‰å…³ `make` æˆ–å…¶ä»– Forge API çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [Electron Forge CLI æ–‡æ¡£](https://www.electronforge.io/cli#commands)ã€‚

æ‚¨è¿˜åº”è¯¥æ³¨æ„åˆ°æ‚¨çš„ package.json ç°åœ¨å®‰è£…äº†æ›´å¤šçš„åŒ… åœ¨ `devDependencies` ä¸‹ï¼Œä»¥åŠä¸€ä¸ªå¯¼å‡ºé…ç½®çš„æ–° `forge.config.js` æ–‡ä»¶ ç›®çš„ã€‚ æ‚¨åº”è¯¥åœ¨é¢„å¡«å……çš„é…ç½®ä¸­çœ‹åˆ°å¤šä¸ªmakersï¼ˆç”Ÿæˆå¯åˆ†å‘åº”ç”¨ç¨‹åºåŒ…çš„åŒ…ï¼‰ï¼Œæ¯ä¸ªç›®æ ‡å¹³å°ä¸€ä¸ªã€‚

### åˆ›å»ºä¸€ä¸ªå¯åˆ†å‘ç‰ˆæœ¬

è¦åˆ›å»ºå¯åˆ†å‘æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨é¡¹ç›®ä¸­çš„ `make` è„šæœ¬ï¼Œè¯¥è„šæœ¬æœ€ç»ˆè¿è¡Œäº† `electron-forge make` å‘½ä»¤ã€‚

- npm
- Yarn

```sh
npm run make
```



è¯¥ `make` å‘½ä»¤åŒ…å«ä¸¤æ­¥ï¼š

1. å®ƒå°†é¦–å…ˆè¿è¡Œ `electron-forge package` ï¼ŒæŠŠæ‚¨çš„åº”ç”¨ç¨‹åº ä»£ç ä¸ Electron äºŒè¿›åˆ¶åŒ…ç»“åˆèµ·æ¥ã€‚ å®Œæˆæ‰“åŒ…çš„ä»£ç å°†ä¼šè¢«ç”Ÿæˆåˆ°ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶å¤¹ä¸­ã€‚
2. ç„¶åå®ƒå°†ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸ºæ¯ä¸ª maker é…ç½®ç”Ÿæˆä¸€ä¸ªå¯åˆ†å‘æ–‡ä»¶ã€‚

åœ¨è„šæœ¬è¿è¡Œåï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä¸€ä¸ª `out` æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…æ‹¬å¯åˆ†å‘æ–‡ä»¶ä¸ä¸€ä¸ªåŒ…å«å…¶æºç çš„æ–‡ä»¶å¤¹ã€‚

macOS output example

```plain
out/
â”œâ”€â”€ out/make/zip/darwin/x64/my-electron-app-darwin-x64-1.0.0.zip
â”œâ”€â”€ ...
â””â”€â”€ out/my-electron-app-darwin-x64/my-electron-app.app/Contents/MacOS/my-electron-app
```



`out/make` æ–‡ä»¶å¤¹ä¸­çš„åº”ç”¨ç¨‹åºåº”è¯¥å¯ä»¥å¯åŠ¨äº†ï¼ ç°åœ¨ï¼Œæ‚¨å·²ç»åˆ›å»ºäº†ä½ çš„ç¬¬ä¸€ä¸ª Electron ç¨‹åºã€‚

å¯åˆ†å‘æ–‡ä»¶æ ¼å¼

Electron Forge é€šè¿‡é…ç½®å¯ä»¥ä¸ºä¸åŒçš„æ“ä½œç³»ç»Ÿåˆ›å»ºç‰¹å®šæ ¼å¼çš„å¯åˆ†å‘æ–‡ä»¶ (ä¾‹å¦‚ DMGã€debã€MSI ç­‰)ã€‚ ç›¸å…³é…ç½®é€‰é¡¹è¯¦æƒ…ï¼Œè¯·å‚é˜… Forge çš„ [Makers](https://www.electronforge.io/config/makers) æ–‡æ¡£ã€‚

åˆ›å»ºå’Œæ·»åŠ åº”ç”¨ç¨‹åºå›¾æ ‡

è®¾ç½®è‡ªå®šä¹‰çš„åº”ç”¨ç¨‹åºå›¾æ ‡ï¼Œéœ€è¦æ·»åŠ ä¸€äº›é¢å¤–çš„é…ç½®ã€‚ æŸ¥çœ‹ [Forge çš„å›¾æ ‡æ•™ç¨‹](https://www.electronforge.io/guides/create-and-add-icons) äº†è§£æ›´å¤šä¿¡æ¯ã€‚

ä¸ä½¿ç”¨ ELECTRON FORGE æ‰“åŒ…

å¦‚æœæ‚¨æƒ³æ‰‹åŠ¨æ‰“åŒ…ä»£ç ï¼Œæˆ–è€…æ˜¯æƒ³äº†è§£ Electron çš„æ‰“åŒ…æœºåˆ¶ï¼Œå¯ä»¥æŸ¥çœ‹å®Œæ•´çš„ [åº”ç”¨ç¨‹åºæ‰“åŒ…](https://www.electronjs.org/zh/docs/latest/tutorial/application-distribution) æ–‡æ¡£ã€‚

## é‡è¦æç¤ºï¼šå¯¹ä»£ç è¿›è¡Œç­¾å

ä¸ºäº†å°†æ¡Œé¢åº”ç”¨ç¨‹åºåˆ†å‘ç»™æœ€ç»ˆç”¨æˆ·ï¼Œæˆ‘ä»¬ *å¼ºçƒˆå»ºè®®* æ‚¨å¯¹ Electron åº”ç”¨è¿›è¡Œ **ä»£ç ç­¾å**ã€‚ ä»£ç ç­¾åæ˜¯äº¤ä»˜æ¡Œé¢åº”ç”¨ç¨‹åºçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶ä¸”å®ƒå¯¹äºåº”ç”¨ç¨‹åºçš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ (å°†ä¼šåœ¨æ•™ç¨‹æœ€åéƒ¨åˆ†è®²è§£) æ¥è¯´æ˜¯å¿…éœ€çš„ã€‚

ä»£ç ç­¾åæ˜¯ä¸€ç§å¯ç”¨äºè¯æ˜æ¡Œé¢åº”ç”¨ç¨‹åºæ˜¯ç”±å·²çŸ¥æ¥æºåˆ›å»ºçš„å®‰å…¨æŠ€æœ¯ã€‚ Windows å’Œ macOS æ‹¥æœ‰å…¶ç‰¹å®šçš„ä»£ç ç­¾åç³»ç»Ÿï¼Œè¿™å°†ä½¿ç”¨æˆ·éš¾ä»¥ä¸‹è½½æˆ–å¯åŠ¨æœªç­¾åçš„åº”ç”¨ç¨‹åºã€‚

åœ¨ macOS ä¸Šï¼Œä»£ç ç­¾åæ˜¯åœ¨åº”ç”¨ç¨‹åºæ‰“åŒ…æ—¶å®Œæˆçš„ã€‚ è€Œåœ¨ Windows ä¸­ï¼Œåˆ™æ˜¯å¯¹å¯åˆ†å‘æ–‡ä»¶è¿›è¡Œç­¾åæ“ä½œã€‚ å¦‚æœæ‚¨å·²ç»æ‹¥æœ‰é€‚ç”¨äº Windows å’Œ macOS çš„ä»£ç ç­¾åè¯ä¹¦ï¼Œå¯ä»¥åœ¨ Forge é…ç½®ä¸­è®¾ç½®æ‚¨çš„å‡­æ®ã€‚

INFO

æ¬²äº†è§£æ›´å¤šä»£ç ç­¾åçš„ä¿¡æ¯ï¼Œè¯·å‚é˜…Forgeæ–‡æ¡£ä¸­çš„ [ç­¾ç½² macOS åº”ç”¨ç¨‹åº](https://www.electronforge.io/guides/code-signing) æŒ‡å—ã€‚

- macOS
- Windows

forge.config.js

```js
module.exports = {
  packagerConfig: {
    osxSign: {},
    // ...
    osxNotarize: {
      tool: 'notarytool',
      appleId: process.env.APPLE_ID,
      appleIdPassword: process.env.APPLE_PASSWORD,
      teamId: process.env.APPLE_TEAM_ID
    }
    // ...
  }
}
```



## æ‘˜è¦

Electron åº”ç”¨ç¨‹åºéœ€è¦æ‰“åŒ…ååˆ†å‘ç»™ç”¨æˆ·ã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†åº”ç”¨ç¨‹åºå¯¼å…¥ Electron Forge å¹¶å¯¹å…¶è¿›è¡Œé…ç½®ä»¥æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åºå¹¶ç”Ÿæˆå®‰è£…ç¨‹åºã€‚

ä¸ºäº†è®©åº”ç”¨ç¨‹åºå—åˆ°ç”¨æˆ·ç³»ç»Ÿçš„ä¿¡ä»»ï¼Œæ‚¨éœ€è¦ä»¥æ•°å­—ç­¾åè¯æ˜å¯åˆ†å‘æ–‡ä»¶çš„å†…å®¹æ˜¯çœŸå®çš„å¹¶ä¸”æœªè¢«ä»£ç ç­¾åç¯¡æ”¹ã€‚ åªè¦åœ¨åº”ç”¨é…ç½®ä¸­æ·»åŠ ç­¾åè¯ä¹¦ä¿¡æ¯ï¼Œæ‚¨å°±å¯ä»¥é€šè¿‡ Forge å¯¹å…¶è¿›è¡Œç­¾åã€‚

# å‘å¸ƒå’Œæ›´æ–°

æ•™ç¨‹ç›®å½•

è¿™æ˜¯ Electron æ•™ç¨‹çš„ **ç¬¬å…­éƒ¨åˆ†**

1. [åŸºæœ¬è¦æ±‚](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-prerequisites)
2. [åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app)
3. [ä½¿ç”¨é¢„åŠ è½½è„šæœ¬](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-preload)
4. [æ·»åŠ åŠŸèƒ½](https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-adding-features)
5. [æ‰“åŒ…æ‚¨çš„åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/æ‰“åŒ…æ•™ç¨‹)
6. **[å‘å¸ƒå’Œæ›´æ–°](https://www.electronjs.org/zh/docs/latest/tutorial/æ¨é€æ›´æ–°æ•™ç¨‹)**

## å­¦ä¹ ç›®æ ‡

è¯·æ³¨æ„ï¼Œè¿™æ˜¯æœ¬æ•™ç¨‹çš„æœ€åä¸€æ­¥ï¼ åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†å‘å¸ƒåº”ç”¨åˆ° GitHub ç‰ˆæœ¬ä¸­å¿ƒï¼Œå¹¶å°†è‡ªåŠ¨æ›´æ–°åŠŸèƒ½æ•´åˆåˆ°åº”ç”¨ä»£ç ä¸­ã€‚

## ä½¿ç”¨ update.electronjs.org

Electron å®˜æ–¹åœ¨ [https://update.electronjs.org](https://update.electronjs.org/) ä¸Šä¸ºå¼€æºåº”ç”¨ç¨‹åºæä¾›äº†å…è´¹çš„è‡ªåŠ¨æ›´æ–°æœåŠ¡ã€‚ ä½¿ç”¨å®ƒæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ±‚ï¼š

- ä½ çš„åº”ç”¨åœ¨ macOS æˆ– Windows ä¸Šè¿è¡Œ
- ä½ çš„åº”ç”¨æœ‰ä¸€ä¸ªå…¬å¼€çš„ GitHub ä»“åº“
- åº”ç”¨ç¨‹åºéœ€è¦å‘å¸ƒåˆ° [GitHub releases](https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository) ä¸­
- åº”ç”¨ç¨‹åºéœ€è¦å®Œæˆ [ç­¾å](https://www.electronjs.org/zh/docs/latest/tutorial/code-signing)

è‡³æ­¤ï¼Œæˆ‘ä»¬å‡è®¾ä½ å·²å°†æ‰€æœ‰ä»£ç æ¨é€åˆ°å…¬å¼€çš„ GitHub ä»“åº“ã€‚

æ›¿ä»£æ›´æ–°æœåŠ¡

å¦‚æœæ‚¨ä½¿ç”¨äº†å…¶ä»–å­˜å‚¨åº“ä¸»æœº (ä¾‹å¦‚ GitLab æˆ– Bitbucket)ï¼Œæˆ–è€…å¦‚æœæ‚¨ä½ çš„ä»£ç ä»“åº“ä¸èƒ½å…¬å¼€ï¼Œè¯·å‚é˜… [æ›´æ–°åº”ç”¨ç¨‹åº](https://www.electronjs.org/zh/docs/latest/tutorial/updates) æ•™ç¨‹ä»¥æ‰˜ç®¡æ‚¨è‡ªå·±çš„ Electron æ›´æ–°æœåŠ¡å™¨ã€‚

## å‘å¸ƒä¸€ä¸ª GitHub ç‰ˆæœ¬

Electron Forge çš„ [Publisher](https://www.electronforge.io/config/publishers) æ’ä»¶å¯ä»¥è‡ªåŠ¨å°†æ‰“åŒ…çš„åº”ç”¨ç¨‹åºåˆ†å‘åˆ°å„ç§æ¥æºã€‚ åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºä½¿ç”¨ GitHub Publisher å°†ä»£ç å‘å¸ƒåˆ° GitHub releases ä¸­ã€‚

### ç”Ÿæˆä¸ªäººè®¿é—®ä»¤ç‰Œ

æœªç»è®¸å¯ï¼ŒForgeæ— æ³•å‘GitHub ä¸Šçš„ä»»ä½•ä»“åº“å‘å¸ƒã€‚ ä½ éœ€è¦é€šè¿‡ä¸€ä¸ªè®¤è¯ä»¤ç‰Œï¼Œæˆæƒ Forge ä½¿ç”¨ GitHub çš„å‘å¸ƒåŠŸèƒ½ã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯ [åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸ªäººè®¿é—®ä»¤ç‰Œ (PAT)](https://github.com/settings/tokens/new) èŒƒå›´ä¸º `public_repo`, å®ƒå°†ç»™ä½ çš„å…¬å…±èµ„æºåº“æä¾›å†™è®¿é—®æƒé™ã€‚ **è¯·ç¡®ä¿æ­¤ä»¤ç‰Œä¸å¤–æ³„ã€‚**

### è®¾ç½® GitHub å‘å¸ƒè€…

#### å®‰è£…æ¨¡å—

Forge çš„ [GitHub Publisher](https://www.electronforge.io/config/publishers/github) æ˜¯ä¸€ä¸ªæ’ä»¶, å®ƒéœ€è¦è¢«å®‰è£…åˆ°ä½ çš„é¡¹ç›®çš„ `devDependencies` é‡Œé¢å»:

- npm
- Yarn

```sh
npm install --save-dev @electron-forge/publisher-github
```



#### åœ¨ Forge ä¸­é…ç½®å‘å¸ƒè€…

ä¸€æ—¦å®‰è£…å®Œæ¯•ï¼Œä½ éœ€è¦åœ¨ Forge é…ç½®ä¸­è®¾ç½®å®ƒã€‚ å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨åœ¨ Forge çš„ [`PublisherGitHubConfig`](https://js.electronforge.io/interfaces/_electron_forge_publisher_github.PublisherGitHubConfig.html) API æ–‡æ¡£ä¸­ã€‚

forge.config.js

```js
module.exports = {
  publishers: [
    {
      name: '@electron-forge/publisher-github',
      config: {
        repository: {
          owner: 'github-user-name',
          name: 'github-repo-name'
        },
        prerelease: false,
        draft: true
      }
    }
  ]
}
```

å‘å¸ƒå‰çš„è‰æ¡ˆç‰ˆæœ¬

è¯·æ³¨æ„ï¼Œä½ å·²é…ç½® Forge æ¥å‘å¸ƒä½ çš„é¡¹ç›®ä½œä¸ºè‰ç¨¿ç‰ˆæœ¬ã€‚ è¿™å°†ä½¿æ‚¨èƒ½å¤Ÿçœ‹åˆ°å…¶ç”Ÿæˆçš„ç»“æœè€Œæ— éœ€å®é™…å‘å¸ƒç»™ä½ çš„æœ€ç»ˆç”¨æˆ·ã€‚ å½“ä½ å†™ä¸‹ç‰ˆæœ¬è¯´æ˜å’Œå¹¶å¤šæ¬¡æ£€æŸ¥åˆ†å‘çš„å·¥ä½œå†…å®¹å, å°±å¯ä»¥æ‰‹åŠ¨åœ¨ Github ä¸Šå‘å¸ƒä½ çš„åº”ç”¨.

#### è®¾ç½®èº«ä»½éªŒè¯ token

ä½ è¿˜éœ€è¦è®©å‘å¸ƒå™¨äº†è§£ä½ çš„èº«ä»½éªŒè¯ä»¤ç‰Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†ä½¿ç”¨å­˜å‚¨åœ¨ `GITHUB_TOKEN` ç¯å¢ƒå˜é‡çš„å€¼ã€‚

### è¿è¡Œå‘å¸ƒå‘½ä»¤

å°† Forge çš„ [å‘å¸ƒå‘½ä»¤](https://www.electronforge.io/cli#publish) æ·»åŠ åˆ° npm è„šæœ¬å†…ã€‚

package.json

```json
  //...
  "scripts": {
    "start": "electron-forge start",
    "package": "electron-forge package",
    "make": "electron-forge make",
    "publish": "electron-forge publish"
  },
  //...
```

æ­¤å‘½ä»¤å°†è¿è¡Œä½ é…ç½®çš„åˆ›å»ºæ–¹æ³•å¹¶å°†è¾“å‡ºçš„å¯åˆ†å‘æ–‡ä»¶å‘å¸ƒåˆ°æ–°çš„ GitHub ç‰ˆæœ¬ã€‚

- npm
- Yarn

```sh
npm run publish
```



é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™åªä¼šä¸ºä½ å½“å‰çš„ä¸»æœºæ“ä½œç³»ç»Ÿæ¶æ„å‘å¸ƒä¸€ä¸ªå•ä¸€çš„å¯åˆ†å‘æ–‡ä»¶ã€‚ ä½ å¯ä»¥é€šè¿‡å°† `--arch` å‚æ•°ä¼ é€’ç»™ Forge å‘½ä»¤æ¥å‘å¸ƒä¸åŒçš„æ¶æ„ã€‚

ç‰ˆæœ¬çš„åç§°å°†å¯¹åº”äºé¡¹ç›®çš„ package.json æ–‡ä»¶ä¸­çš„ `version` å­—æ®µã€‚

å‘å¸ƒæ—¶æ‰“ä¸Šæ ‡ç­¾

å¯é€‰çš„, ä½ ä¹Ÿå¯ä»¥ [åœ¨Gitä¸Šå¯¹ç‰ˆæœ¬æ‰“æ ‡ç­¾](https://git-scm.com/book/en/v2/Git-Basics-Tagging), è¿™æ ·ä½ çš„ç‰ˆæœ¬å°†å…³è”åˆ°ä¸€ä¸ªä»£ç å†å²ä¸­çš„æ ‡ç­¾ç‚¹. npmé™„å¸¦äº†ä¸€ä¸ªæ–¹ä¾¿çš„ [`npm version`](https://docs.npmjs.com/cli/v8/commands/npm-version) å‘½ä»¤ï¼Œå¯ä»¥ä¸ºä½ å¤„ç†ç‰ˆæœ¬ç¢°æ’æˆ–æ‰“æ ‡ç­¾.

#### å°æŠ€å·§ï¼šåœ¨ GitHub Actions ä¸­å‘å¸ƒ

æœ¬åœ°å‘å¸ƒçš„ç‰ˆæœ¬å¯èƒ½å¾ˆå•ä¸€ï¼Œå› ä¸ºåªèƒ½ä¸ºä½ çš„ä¸»æœºæ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ç§ç‰ˆæœ¬ (æ¯”å¦‚, ä½ ä¸èƒ½ä» macOS ç³»ç»Ÿä¸Šå‘å¸ƒ Window ç³»ç»Ÿçš„ `.exe` æ–‡ä»¶)ã€‚

ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡è‡ªåŠ¨åŒ–å·¥ä½œæµæ¥å‘å¸ƒä½ çš„åº”ç”¨æ¯”å¦‚ [GitHub Actions](https://github.com/features/actions), é€šè¿‡å®ƒå¯ä»¥åœ¨å„ç§äº‘ç³»ç»Ÿå†…åŒ…æ‹¬ Ubuntu, macOS å’Œ Windows ä¸Šè¿è¡Œä»»åŠ¡. è¿™æ˜¯ [Electron Fiddle](https://www.electronjs.org/fiddle) é‡‡ç”¨çš„ç²¾ç¡®æ–¹æ³•. ä½ å¯ä»¥å‚è€ƒ Fiddle çš„ [æ„å»ºå’Œå‘å¸ƒä¸€æ¡é¾™ ](https://github.com/electron/fiddle/blob/main/.github/workflows/build.yaml)ä»¥åŠ [Forge é…ç½®](https://github.com/electron/fiddle/blob/main/forge.config.js) äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

## æ£€æµ‹æ›´æ–°ç¨‹åºä»£ç 

è‡³æ­¤æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªé€šè¿‡ GitHub å‘å¸ƒçš„åŠŸèƒ½æ€§å‘å¸ƒç³»ç»Ÿï¼Œ æˆ‘ä»¬ç°åœ¨éœ€è¦å‘Šè¯‰æˆ‘ä»¬çš„ Electron åº”ç”¨æ¥ä¸‹è½½æ›´æ–°ï¼Œè€Œä¸”æ˜¯æ¯å½“æ–°ç‰ˆæœ¬å‡ºç°æ—¶éƒ½éœ€è¦æ›´æ–°ã€‚ Electron åº”ç”¨é€šè¿‡ [autoUpdater](https://www.electronjs.org/zh/docs/latest/api/auto-updater) æ¨¡å—æ¥å®ç°æ­¤åŠŸèƒ½, æ­¤æ¨¡å—å¯ä»¥ä»æ›´æ–°æœåŠ¡æºä¸­è¯»å–ä¿¡æ¯, å¹¶æ£€æŸ¥æ˜¯å¦æœ‰ä¸€ä¸ªæ–°ç‰ˆæœ¬å¯ä¾›ä¸‹è½½.

ç½‘å€æ˜¯ update.electronjs.org çš„æœåŠ¡å™¨æä¾›äº†ä¸€ä¸ªå…¼å®¹æ›´æ–°æº. æ¯”å¦‚, Electron Fiddle v0.28.0 å°†ä¼šæ£€æŸ¥æ¥å£ https://update.electronjs.org/electron/fiddle/darwin/v0.28.0 æ¥æŸ¥çœ‹æ˜¯å¦æœ‰æ–°çš„ GitHub ç‰ˆæœ¬å¯ç”¨.

ä¸€æ—¦ä½ çš„å‘å¸ƒç‰ˆæœ¬è¢«æ¨é€åˆ° GitHub, å¯¹åº”çš„æ›´æ–°æœåŠ¡ update.electronjs.org å°†ä¼šè‡ªåŠ¨å¯¹æ¥ä½ çš„åº”ç”¨. å‰©ä¸‹çš„å”¯ä¸€æ­¥éª¤æ˜¯ä½¿ç”¨ autoUpdater æ¨¡å—é…ç½®æºã€‚

ä¸ºäº†è®©æ•´ä¸ªè¿‡ç¨‹æ›´åŠ ç®€å•, Electron å›¢é˜Ÿç»´æŠ¤ [`update-electron-app`](https://github.com/electron/update-electron-app) æ¨¡å—, å®ƒåœ¨ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¸­ä¸º update.electronjs.org è®¾ç½®äº† autoUpdater æ ·æ¿ï¼Œæ— éœ€é…ç½®ã€‚ è¿™ä¸ªæ¨¡å—å°†æœç´¢ update.electronjs.org æºä¸­ä¸é¡¹ç›®å†… package.json çš„`"repository"` å­—æ®µåŒ¹é…çš„éƒ¨åˆ†ã€‚

é¦–å…ˆï¼Œå®‰è£…æ¨¡å—ä½œä¸ºè¿è¡Œæ—¶çš„ä¾èµ–é¡¹

- npm
- Yarn

```sh
npm install update-electron-app
```



ç„¶åå¯¼å…¥æ¨¡å—å¹¶åœ¨ä¸»è¿›ç¨‹ä¸­ç«‹å³è°ƒç”¨

main.js

```js
require('update-electron-app')()
```



è¿™æ˜¯éœ€è¦åšçš„äº‹æƒ…ï¼ ä¸€æ—¦ä½ çš„åº”ç”¨ç¨‹åºè¢«æ‰“åŒ…ï¼Œå®ƒå°†åœ¨ä½ å‘å¸ƒæ¯ä¸ªæ–°çš„ GitHub ç‰ˆæœ¬æ—¶æ›´æ–°è‡ªå·±ã€‚

## æ‘˜è¦

åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬é…ç½® Electron Forge çš„ GitHub Publisher æ¥ä¸Šä¼ ä½ çš„åº”ç”¨çš„ å‘è¡Œç‰ˆåˆ° GitHub releasesã€‚ ç”±äºå¯åˆ†å‘æ–‡ä»¶ä¸èƒ½æ€»æ˜¯åœ¨ä¸åŒçš„å¹³å°ä¹‹é—´ç”Ÿæˆ æ„å»ºå’Œå‘å¸ƒæµç¨‹ï¼Œå¦‚æœä½ ä¸èƒ½è®¿é—®æœºå™¨ï¼Œæˆ‘ä»¬å»ºè®®å°†ä½ çš„æ„å»ºå’Œå‘å¸ƒæµç¨‹è®¾ç½®åœ¨æŒç»­é›†æˆç®¡é“ä¸­ã€‚

Electron åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡å°† autoUpdater æ¨¡å—æŒ‡å‘ä¸€ä¸ªæ›´æ–°æœåŠ¡å™¨æ¥è¿›è¡Œè‡ªæˆ‘æ›´æ–°ã€‚ update.electronjs.org æ˜¯ä¸€ä¸ª Electron ä¸ºå¼€æºåº”ç”¨ç¨‹åº å…è´¹æä¾›çš„æ›´æ–°æœåŠ¡å™¨ï¼Œå‘å¸ƒåœ¨ GitHub Releases ä¸Šã€‚ é…ç½®ä½ çš„Electronåº”ç”¨æ¥ä½¿ç”¨è¿™ä¸ªæœåŠ¡æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œå°±åƒ å®‰è£…å¹¶å¯¼å…¥ `update-electron-app` æ¨¡å—ä¸€æ ·ã€‚

å¦‚æœä½ çš„åº”ç”¨ç¨‹åºä¸é€‚åˆä½¿ç”¨ update.electronijs.orgï¼Œä½ åº”è¯¥è‡ªå·±éƒ¨ç½² ä¸€ä¸ªæ›´æ–°æœåŠ¡å™¨ï¼Œå¹¶é…ç½®è‡ªå·±çš„è‡ªåŠ¨ autoUpdater æ¨¡å—ã€‚

ğŸŒŸ ä½ å®Œæˆäº†

ä»è¿™é‡Œå¼€å§‹ï¼Œæ‚¨å·²ç»æ­£å¼å®Œæˆäº†æˆ‘ä»¬çš„ Electron æ•™ç¨‹ã€‚ è¯·è‡ªç”±çš„æ¢ç´¢æˆ‘ä»¬çš„å‰©ä½™æ–‡æ¡£å¹¶å¿«ä¹çš„å¼€å‘ï¼ å¦‚æœæ‚¨æœ‰ç–‘é—®ï¼Œè¯·å‰å¾€æˆ‘ä»¬çš„ç¤¾åŒº [Discord æœåŠ¡å™¨](https://discord.gg/electronjs) ã€‚

